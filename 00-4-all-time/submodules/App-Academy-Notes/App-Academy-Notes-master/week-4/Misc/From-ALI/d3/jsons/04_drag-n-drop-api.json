{
  "template": {
    "taskId": "c79caf1b-49c1-46fc-8ad7-3fa3abc499ee",
    "name": "Drag n Drop API",
    "repo": "Modular-Curriculum",
    "path": "content/dom/topics/event-handling/readings/reading-4-drag-and-drop-api-js.md",
    "type": "Reading",
    "timeEstimate": 600,
    "urls": [
      "drag-n-drop-api"
    ],
    "topic": "Homework for Wednesday",
    "subtopic": "Homework",
    "body": "# Event Handling: HTML Drag-And-Drop API\n\nDragging and dropping a page element is a fun and convenient way for users to\ninteract with a Web page! HTML drag-and-drop interfaces are most commonly used\nfor dragging files, such as PDFs or images, onto a page in a specified area\nknown as a _drop zone_.\n\nWhile less typical than button clicks and form submission events, HTML\ndrag-and-drop is relevant to event handling because it uses the [DOM event\nmodel][1] and [drag events][2] inherited from [mouse events][3].\n\nThis reading will go over how to use the [HTML Drag and Drop API][4] to create\n\"draggable\" page elements and allow users to drop them into a drop zone.\n\n## Basic drag-and-drop functions\n\nLetâ€™s go over how to set up basic drag-and-drop functionality, according to the\n[MDN documentation][4]. You'll need to mark an element as \"draggable\". Then, to\ndo something with that dragging, you need\n\n- A _dragstart_ handler -- occurs when the user clicks the mouse and starts\n  dragging\n- A _drop_ handler -- occurs when the user releases the mouse click and \"drops\"\n  the element\n\nYou will also see how to use the `dragenter` and `dragleave` events to do some\nnice interactions.\n\n## The example\n\nHere's an HTML document that you can copy and paste into a text editor if you\nwant to follow along.\n\n```html\n\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"UTF-8\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n  <title>Red Square is a Drag</title>\n  <style>\n    #red-square {\n      background-color: red;\n      box-sizing: border-box;\n      height: 100px;\n      width: 100px;\n    }\n  </style>\n</head>\n<body>\n  <div id=\"red-square\"></div>\n</body>\n</html>\n```\n\nYou don't need to know what `box-sizing` does. That'll be covered in future\nlessons. It's in this example to make sure the box looks ok when it's dragged.\n\n## The first step of drag and drop\n\nThe first step to making an element draggable is to add that attribute to the\nelement itself. Change the red square `div` to have the `draggable` attribute\nwith a value of \"true\".\n\n```html\n  <div id=\"red-square\" draggable=\"true\"></div>\n```\n\nNow, if you refresh your page, you can start dragging the red square. When you\nrelease it, it will \"snap\" back to it's original position.\n\n![draggable red square](https://assets.aaonline.io/Module-DOM-API/event-handling/assets/drag-red-square-1.gif)\n\n### Handling the start of a drag\n\nNow that the element is draggable, you need some JavaScript to handle the event\nof when someone starts dragging an element. This is there so that your code\nknows what's being dragged! Otherwise, how will it know what to do when the\ndragging ends?\n\nThe following code creates a handler for the `dragstart` event. Then, it\nsubscribes to the red square's `dragstart` event with that event handler. The\nevent handler, in this case, will add a class to the red square to make it show\nthat it's being dragged. Then, it adds the value of the `id` of the element to\nthe \"data transfer\" object. The \"data transfer\" object holds all of the\ninformation that will be needed when the dragging operation ends.\n\nThe `classList` object for the HTML element is just a way to add and remove\nCSS classes to and from a DOM object. You're not going to be tested over that\nbit of information for some weeks, so don't worry about remembering it. Just\nunderstand that using the `add` method on it _adds_ the CSS class to the HTML\nelement.\n\n```html\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"UTF-8\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n  <title>Red Square is a Drag</title>\n  <script type=\"text/javascript\">\n    const handleDragStart = e => {\n      e.target.classList.add('is-being-dragged');\n      e.dataTransfer.setData('text/plain', e.target.id);\n      e.dataTransfer.dropEffect = 'move';\n    }\n    window.addEventListener('DOMContentLoaded', () => {\n      document\n        .getElementById('red-square')\n        .addEventListener('dragstart', handleDragStart);\n    });\n  </script>\n  <style>\n    #red-square {\n      background-color: red;\n      box-sizing: border-box;\n      height: 100px;\n      width: 100px;\n    }\n\n    .is-being-dragged {\n      opacity: 0.5;\n      border: 2px dashed white;\n    }\n  </style>\n</head>\n<body>\n  <div id=\"red-square\"></div>\n</body>\n</html>\n```\n\nIf you update your version of the code, you can now see that the square's border\ngets all dashy when you drag it!\n\n![draggable red square with dashed border](https://assets.aaonline.io/Module-DOM-API/event-handling/assets/drag-red-square-2.gif)\n\n### The drop zone is all clear!\n\nA drop zone is just another HTML element. Put another `div` in your HTML and\ngive it an id of `drop-zone`. It could, conceivably, look like this.\n\n```html\n<body>\n  <div id=\"red-square\"></div>\n  <div id=\"drop-zone\">drop zone</div>\n</body>\n```\n\nTo make it visible, add some CSS. Note that most of that in there is to make it\nlook pretty. You should understand the simple things like \"background-color\" and\n\"color\" and \"font-size\", \"height\" and \"width\". You won't yet be tested on any of\nthose other properties. But, feel free to play around with them!\n\n```html\n<style>\n  #drop-zone {\n    align-items: center;\n    border: 1px solid #DDD;\n    color: #CCC;\n    display: flex;\n    font-family: Arial, Helvetica, sans-serif;\n    font-size: 2em;\n    font-weight: bold;\n    height: 200px;\n    justify-content: center;\n    position: absolute;\n    right: 0;\n    width: 200px;\n  }\n\n  #red-square {\n    background-color: red;\n    box-sizing: border-box;\n    height: 100px;\n    width: 100px;\n  }\n\n  .is-being-dragged {\n    opacity: 0.5;\n    border: 2px dashed white;\n  }\n</style>\n```\n\n![draggable red square with dashed border and drop zone](https://assets.aaonline.io/Module-DOM-API/event-handling/assets/drag-red-square-3.1.png)\n\n### Handle when the red square gets enters the drop zone (and leaves)\n\nThis is another couple of JavaScript event handlers, but this time, it will\nhandle the `dragenter` and `dragleave` events on the drop zone element. You can\nreplace the `<script>` tag in your HTML with this version, here, to handle those\nevents. Note that the `handleDragEnter` event handler merely adds a CSS class to\nthe drop zone. The `handleDragLeave` removes the CSS class. Then, in the\n`DOMContentLoaded` event handler, the last three lines gets a reference to the\ndrop zone element and attaches the event handlers to it.\n\n```html\n<script type=\"text/javascript\">\n  const handleDragStart = e => {\n    e.target.classList.add('is-being-dragged');\n    e.dataTransfer.setData('text/plain', e.target.id);\n    e.dataTransfer.dropEffect = 'move';\n  };\n\n  const handleDragEnter = e => {\n    e.target.classList.add('is-active-drop-zone');\n  };\n\n  const handleDragLeave = e => {\n    e.target.classList.remove('is-active-drop-zone');\n  };\n\n  window.addEventListener('DOMContentLoaded', () => {\n    document\n      .getElementById('red-square')\n      .addEventListener('dragstart', handleDragStart);\n\n    const dropZone = document.getElementById('drop-zone');\n    dropZone.addEventListener('dragenter', handleDragEnter);\n    dropZone.addEventListener('dragleave', handleDragLeave);\n  });\n</script>\n```\n\nThe CSS to make the item change looks like this. Just add the class to the\n`<style>` tag in the HTML.\n\n```css\n.is-active-drop-zone {\n  background-color: blue;\n}\n```\n\nJust look at that drop zone turn blue with glee!\n\n![draggable red square with dashed border and active drop zone](https://assets.aaonline.io/Module-DOM-API/event-handling/assets/drag-red-square-4.gif)\n\n### Do something with a \"drop\"!\n\nFinally, the `drop` event of the drop target handles what happens when you let\ngo of the draggable element over the drop zone. However, there's one small\nproblem. From the MDN documentation on [Drag Operations]:\n\n> If the mouse is released over an element that is a valid drop target, that is,\n> one that cancelled the last `dragenter` or `dragover` event, then the drop\n> will be successful, and a drop event will fire at the target. Otherwise, the\n> drag operation is cancelled, and no drop event is fired.\n\nFor this to work properly, you will _also_ have to subscribe to the `drop` event\nfor the drop zone. Then, in both the handlers for the `drop` and `dragenter`\nevents, you'll need to cancel the event. Recall that in the last article you\nlearned about the `preventDefault()` method on the event object. That's what you\nneed to call in both the `drop` and `dragenter` event handlers to make the\n`drop` event fire.\n\nThat's a lot of words! Here is the final HTML for this little dragging example.\n\n```html\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"UTF-8\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n  <title>Red Square is a Drag</title>\n  <script type=\"text/javascript\">\n    const handleDragStart = e => {\n      e.target.classList.add('is-being-dragged');\n      e.dataTransfer.setData('text/plain', e.target.id);\n      e.dataTransfer.dropEffect = 'move';\n    };\n\n    const handleDragEnter = e => {\n      // Needed so that the \"drop\" event will fire.\n      e.preventDefault();\n      e.target.classList.add('is-active-drop-zone');\n    };\n\n    const handleDragLeave = e => {\n      e.target.classList.remove('is-active-drop-zone');\n    };\n\n    const handleDragOver = e => {\n      // Needed so that the \"drop\" event will fire.\n      e.preventDefault();\n    };\n\n    const handleDrop = e => {\n      const id = e.dataTransfer.getData('text/plain');\n      const draggedElement = document.getElementById(id);\n      draggedElement.draggable = false;\n      e.target.appendChild(draggedElement);\n    };\n\n    window.addEventListener('DOMContentLoaded', () => {\n      document\n        .getElementById('red-square')\n        .addEventListener('dragstart', handleDragStart);\n\n      const dropZone = document.getElementById('drop-zone');\n      dropZone.addEventListener('drop', handleDrop);\n      dropZone.addEventListener('dragenter', handleDragEnter);\n      dropZone.addEventListener('dragleave', handleDragLeave);\n      dropZone.addEventListener('dragover', handleDragOver);\n    });\n  </script>\n  <style>\n    #drop-zone {\n      align-items: center;\n      border: 1px solid #DDD;\n      color: #CCC;\n      display: flex;\n      font-family: Arial, Helvetica, sans-serif;\n      font-size: 2em;\n      font-weight: bold;\n      height: 200px;\n      justify-content: center;\n      position: absolute;\n      right: 0;\n      top: 100px;\n      width: 200px;\n    }\n\n    #red-square {\n      background-color: red;\n      box-sizing: border-box;\n      height: 100px;\n      width: 100px;\n    }\n\n    .is-being-dragged {\n      opacity: 0.5;\n      border: 8px dashed white;\n    }\n\n    .is-active-drop-zone {\n      background-color: blue;\n      color:\n    }\n  </style>\n  </style>\n</head>\n<body>\n  <div id=\"red-square\" draggable=\"true\"></div>\n  <div id=\"drop-zone\">drop zone</div>\n</body>\n</html>\n```\n\n![droppable red square with dashed border and active drop zone](https://assets.aaonline.io/Module-DOM-API/event-handling/assets/drag-red-square-5.gif)\n\n\n## What you learned:\n\nThere is *a lot* going on, here. Here's a quick review of what you should get\nfrom this article.\n\n* HTML has a Drag and Drop API that you can use to do dragging and dropping in\n  an application.\n* To make it so that a person can drag an HTML element around, you add the\n  `draggable=\"true\"` attribute/value pair to the element (or elements) that you\n  want to drag.\n* You can subscribe to one event on the thing you want to drag, the `dragstart`\n  event. That event will allow you to customize the element and save data to the\n  `dataTransfer` object.\n* You can subscribe to four events for the \"drop zone\" element(s): `dragenter`,\n  `dragover`, and `dragleave`. If you want the `drop` event to work, you _must_\n  subscribe to both `dragenter` and `dragover` and cancel the event using the\n  `preventDefault()` method of the event.\n\n[1]: https://developer.mozilla.org/en-US/docs/Web/API/Event\n[2]: https://developer.mozilla.org/en-US/docs/Web/API/DragEvent\n[3]: https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent\n[4]: https://developer.mozilla.org/en-US/docs/Web/API/HTML_Drag_and_Drop_API\n[5]: https://developer.mozilla.org/en-US/docs/Web/API/Document/dragover_event\n[6]: https://developer.mozilla.org/en-US/docs/Web/API/Document/drop_event\n[Drag Operations]: https://developer.mozilla.org/en-US/docs/Web/API/HTML_Drag_and_Drop_API/Drag_operations#drop\n"
  },
  "success": true
}