(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{"+SJH":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}();t.UnorderedSearchIndex=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._tokenToUidToDocumentMap={}}return n(e,[{key:"indexDocument",value:function(e,t,r){"object"!==i(this._tokenToUidToDocumentMap[e])&&(this._tokenToUidToDocumentMap[e]={}),this._tokenToUidToDocumentMap[e][t]=r}},{key:"search",value:function(e,t){for(var r={},n=this._tokenToUidToDocumentMap,o=0,s=e.length;o<s;o++){var a=n[e[o]];if(!a)return[];if(0===o)for(var c=0,u=(d=Object.keys(a)).length;c<u;c++){r[h=d[c]]=a[h]}else for(c=0,u=(d=Object.keys(r)).length;c<u;c++){var h=d[c];"object"!==i(a[h])&&delete r[h]}}var d,l=[];for(o=0,u=(d=Object.keys(r)).length;o<u;o++){h=d[o];l.push(r[h])}return l}}]),e}()},"2Vsb":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){t=t||[];for(var r=e=e||{},i=0;i<t.length;i++)if(null==(r=r[t[i]]))return null;return r}},"36mx":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}();t.AllSubstringsIndexStrategy=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return i(e,[{key:"expandToken",value:function(e){for(var t,r=[],i=0,n=e.length;i<n;++i){t="";for(var o=i;o<n;++o)t+=e.charAt(o),r.push(t)}return r}}]),e}()},"4uLs":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}();var n=/[^a-zа-яё0-9\-']+/i;t.SimpleTokenizer=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return i(e,[{key:"tokenize",value:function(e){return e.split(n).filter((function(e){return e}))}}]),e}()},"6Hz9":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}();t.PrefixIndexStrategy=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return i(e,[{key:"expandToken",value:function(e){for(var t=[],r="",i=0,n=e.length;i<n;++i)r+=e.charAt(i),t.push(r);return t}}]),e}()},"6L3W":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}();t.StemmingTokenizer=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._stemmingFunction=t,this._tokenizer=r}return i(e,[{key:"tokenize",value:function(e){return this._tokenizer.tokenize(e).map(this._stemmingFunction)}}]),e}()},"7NDX":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r("4uLs");Object.defineProperty(t,"SimpleTokenizer",{enumerable:!0,get:function(){return i.SimpleTokenizer}});var n=r("6L3W");Object.defineProperty(t,"StemmingTokenizer",{enumerable:!0,get:function(){return n.StemmingTokenizer}});var o=r("xew/");Object.defineProperty(t,"StopWordsTokenizer",{enumerable:!0,get:function(){return o.StopWordsTokenizer}})},BQ5h:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r("VB+a");Object.defineProperty(t,"CaseSensitiveSanitizer",{enumerable:!0,get:function(){return i.CaseSensitiveSanitizer}});var n=r("NQDk");Object.defineProperty(t,"LowerCaseSanitizer",{enumerable:!0,get:function(){return n.LowerCaseSanitizer}})},"Dl3+":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r("36mx");Object.defineProperty(t,"AllSubstringsIndexStrategy",{enumerable:!0,get:function(){return i.AllSubstringsIndexStrategy}});var n=r("bb35");Object.defineProperty(t,"ExactWordIndexStrategy",{enumerable:!0,get:function(){return n.ExactWordIndexStrategy}});var o=r("6Hz9");Object.defineProperty(t,"PrefixIndexStrategy",{enumerable:!0,get:function(){return o.PrefixIndexStrategy}})},Fga3:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TokenHighlighter=void 0;var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),n=r("Dl3+"),o=r("BQ5h");t.TokenHighlighter=function(){function e(t,r,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._indexStrategy=t||new n.PrefixIndexStrategy,this._sanitizer=r||new o.LowerCaseSanitizer,this._wrapperTagName=i||"mark"}return i(e,[{key:"highlight",value:function(e,t){for(var r=this._wrapText("").length,i=Object.create(null),n=0,o=t.length;n<o;n++)for(var s=this._sanitizer.sanitize(t[n]),a=this._indexStrategy.expandToken(s),c=0,u=a.length;c<u;c++){var h=a[c];i[h]?i[h].push(s):i[h]=[s]}for(var d="",l="",m=0,f=(n=0,e.length);n<f;n++){var p=e.charAt(n);" "===p?(d="",l="",m=n+1):(d+=p,l+=this._sanitizer.sanitize(p)),i[l]&&i[l].indexOf(l)>=0&&(d=this._wrapText(d),e=e.substring(0,m)+d+e.substring(n+1),n+=r,f+=r)}return e}},{key:"_wrapText",value:function(e){var t=this._wrapperTagName;return"<"+t+">"+e+"</"+t+">"}}]),e}()},HUcV:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=t.StopWordsMap={a:!0,able:!0,about:!0,across:!0,after:!0,all:!0,almost:!0,also:!0,am:!0,among:!0,an:!0,and:!0,any:!0,are:!0,as:!0,at:!0,be:!0,because:!0,been:!0,but:!0,by:!0,can:!0,cannot:!0,could:!0,dear:!0,did:!0,do:!0,does:!0,either:!0,else:!0,ever:!0,every:!0,for:!0,from:!0,get:!0,got:!0,had:!0,has:!0,have:!0,he:!0,her:!0,hers:!0,him:!0,his:!0,how:!0,however:!0,i:!0,if:!0,in:!0,into:!0,is:!0,it:!0,its:!0,just:!0,least:!0,let:!0,like:!0,likely:!0,may:!0,me:!0,might:!0,most:!0,must:!0,my:!0,neither:!0,no:!0,nor:!0,not:!0,of:!0,off:!0,often:!0,on:!0,only:!0,or:!0,other:!0,our:!0,own:!0,rather:!0,said:!0,say:!0,says:!0,she:!0,should:!0,since:!0,so:!0,some:!0,than:!0,that:!0,the:!0,their:!0,them:!0,then:!0,there:!0,these:!0,they:!0,this:!0,tis:!0,to:!0,too:!0,twas:!0,us:!0,wants:!0,was:!0,we:!0,were:!0,what:!0,when:!0,where:!0,which:!0,while:!0,who:!0,whom:!0,why:!0,will:!0,with:!0,would:!0,yet:!0,you:!0,your:!0};i.constructor=!1,i.hasOwnProperty=!1,i.isPrototypeOf=!1,i.propertyIsEnumerable=!1,i.toLocaleString=!1,i.toString=!1,i.valueOf=!1},NQDk:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}();t.LowerCaseSanitizer=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return i(e,[{key:"sanitize",value:function(e){return e?e.toLocaleLowerCase().trim():""}}]),e}()},Qtz0:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"d",(function(){return n})),r.d(t,"b",(function(){return o})),r.d(t,"c",(function(){return a}));const i=e=>new Promise((t,r)=>{const i=new Image;i.addEventListener("load",()=>{t({width:i.naturalWidth,height:i.naturalHeight})}),i.addEventListener("error",r),i.src=e}),n=e=>new Promise((t,r)=>{let i=new Image;i.onload=()=>t({src:i.src}),i.onerror=()=>r(),i.src=e}),o=e=>e&&e.size>1048576;let s;const a=()=>(void 0!==s?Promise.resolve(s):new Promise(e=>{const t=new Image,r=()=>{s=2===t.height,e(s)};t.addEventListener("load",r),t.addEventListener("error",r),t.src="data:image/webp;base64,UklGRi4AAABXRUJQVlA4TCEAAAAvAUAAEB8wAiMwAgSSNtse/cXjxyCCmrYNWPwmHRH9jwMA"})).then(e=>e?"image/webp,image/*,*/*;q=0.8":"image/*,*/*;q=0.8")},Tos6:function(e,t,r){"use strict";var i=r("eWMb"),n=r("IGfZ"),o=r("mjri"),s=r("NubX"),a=r("Bo9c");class c{constructor(e){this.config=e}loadEmoji(){return Object(a.b)(this.config).then(e=>Object(a.a)(e))}}var u=r("v7rN"),h=r("Czhu"),d=r("HbGN"),l=r("CROD"),m=r("Qtz0");class f{constructor(e,t){this.mediaImageQueue=[],this.activeProcessing=0,this.pendingRequests=new Map,this.concurrentDownloadLimit=t&&t.concurrentDownloadLimit||16,this.tokenManager=e}loadMediaImage(e){const t=this.pendingRequests.get(e);if(void 0!==t)return t;const r=new Promise((t,r)=>{this.mediaImageQueue.push({url:e,resolve:t,reject:r}),this.processFromQueue()}).then(t=>(this.pendingRequests.delete(e),t)).catch(t=>{throw this.pendingRequests.delete(e),t});return this.pendingRequests.set(e,r),r}getQueueSize(){return this.mediaImageQueue.length}getActiveDownloads(){return this.activeProcessing}processFromQueue(){for(;this.activeProcessing<this.concurrentDownloadLimit&&this.mediaImageQueue.length>0;){this.activeProcessing++;const e=this.mediaImageQueue.shift(),{url:t,resolve:r,reject:i}=e;this.tokenManager.getToken("read",!1).then(e=>{this.requestMediaEmoji(t,e,!0).then(e=>{r(e),this.completedItem()}).catch(e=>{i(e),this.completedItem()})}).catch(e=>{i(e),this.completedItem()})}}completedItem(){this.activeProcessing--,this.processFromQueue()}delay(e){return new Promise(t=>setTimeout(t,e))}requestMediaEmoji(e,t,r,i=2){return Object(m.c)().then(n=>{const o={headers:{Authorization:"Bearer "+t.jwt,"X-Client-Id":t.clientId,Accept:n}};return fetch(e,o).then(n=>{if(404===n.status&&i>0)return this.delay(600/i).then(()=>this.requestMediaEmoji(e,t,!1,i-1));if(403===n.status&&r)return this.tokenManager.getToken("read",!0).then(t=>this.requestMediaEmoji(e,t,!1));if(n.ok)return n.blob().then(e=>this.readBlob(e));throw new Error(`Unable to load media image. Status=${n.status} ${n.statusText}`)})})}readBlob(e){return new Promise((t,r)=>{const i=new FileReader;i.addEventListener("load",()=>t(i.result)),i.addEventListener("error",()=>r(i.error)),i.readAsDataURL(e)})}}var p=r("bShy");const g=(e,t)=>t?e.altRepresentation:e.representation;class y{constructor(e){this.cachedImageUrls=new Set,Object(s.a)("BrowserCacheStrategy"),this.mediaImageLoader=e}loadEmoji(e,t){const r=g(e,t);if(!Object(o.l)(r))return e;const{mediaPath:i}=r;return this.cachedImageUrls.has(i)?e:this.mediaImageLoader.loadMediaImage(i).then(()=>(this.cachedImageUrls.add(i),e)).catch(()=>{})}optimisticRendering(){return!0}static supported(e,t){return(()=>{const e=!!document.documentMode,t=!e&&!!window.StyleMedia;return e||t})()?Promise.resolve(!1):t.loadMediaImage(e).then(()=>new Promise(t=>{const r=new Image;r.addEventListener("load",()=>{t(!0)}),r.addEventListener("error",()=>{t(!1)}),r.src=e})).catch(()=>!1)}}class b{constructor(e){Object(s.a)("MemoryCacheStrategy"),this.mediaImageLoader=e,this.dataURLCache=new p.LRUCache(1e3)}loadEmoji(e,t){const r=g(e,t);if(!Object(o.l)(r))return e;const{mediaPath:i}=r,n=this.dataURLCache.get(i);return n?Object(o.d)(e,n,t):this.mediaImageLoader.loadMediaImage(i).then(r=>{const n=Object(o.d)(e,r,t);return r.length<=1e4?this.dataURLCache.put(i,r):Object(s.a)("No caching as image is too large",r.length,r.slice(0,15),e.shortName),n}).catch(()=>{})}optimisticRendering(){return!1}}class v{constructor(e){this.waitingInitUrls=[],Object(s.a)("MediaEmojiCache"),this.mediaImageLoader=new f(e)}loadEmoji(e,t){const r=g(e,t);if(!Object(o.l)(r))return e;const{mediaPath:i}=r,n=this.getCache(i);return Object(o.n)(n)?n.then(r=>r.loadEmoji(e,t)).catch(()=>{}):n.loadEmoji(e,t)}optimisticRendering(e){const t=this.getCache(e);return Object(o.n)(t)?t.then(e=>e.optimisticRendering()).catch(()=>!1):t.optimisticRendering()}getCache(e){return this.cache?this.cache:(this.waitingInitUrls.push(e),this.cacheLoading||(this.cacheLoading=this.initCache().then(e=>(this.cache=e,this.cacheLoading=void 0,e)).catch(e=>{throw this.cacheLoading=void 0,e})),this.cacheLoading)}initCache(){const e=this.waitingInitUrls.pop();return e?y.supported(e,this.mediaImageLoader).then(e=>(this.waitingInitUrls=[],this.cacheLoading=void 0,e?new y(this.mediaImageLoader):new b(this.mediaImageLoader))).catch(()=>this.initCache()):Promise.reject("Unable to initialise cache based on provided url(s)")}}class j{constructor(e){this.siteServiceConfig=e,this.tokens=new Map}addToken(e,t){this.tokens.set(e,{mediaApiToken:t})}getToken(e,t){let r=this.tokens.get(e);r||(r={},this.tokens.set(e,r));const{mediaApiToken:n,activeTokenRefresh:o}=r;if(n){if(Date.now()/1e3<n.expiresAt-30&&!t)return Promise.resolve(n);if(o)return o;r.mediaApiToken=void 0}const s="token/"+e;return r.activeTokenRefresh=i.utils.requestService(this.siteServiceConfig,{path:s}).then(e=>(r.activeTokenRefresh=void 0,r.mediaApiToken=e,e)),r.activeTokenRefresh}}class w{constructor(e,t){this.postToEmojiService=(e,t)=>{const{shortName:r,name:n}=e,{width:s,height:c}=e,u={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({shortName:r,name:n,width:s,height:c,fileId:t})};return i.utils.requestService(this.siteServiceConfig,{requestInit:u}).then(e=>{const{emojis:t}=e;if(t.length){const e=t[0],{altRepresentations:r}=e,i=Object(d.a)(e,["altRepresentations"]),n=Object(h.a)(Object(h.a)({},i),{},{representation:Object(o.c)(i.representation)}),s=Object(a.c)(r||{}),c=s?Object(o.c)(s):void 0;return Object(o.a)(n,c)}throw new Error("No emoji returns from upload. Upload failed.")})},this.siteServiceConfig=e,this.mediaApiToken=t,this.tokenManager=new j(e),this.tokenManager.addToken("read",t),this.mediaEmojiCache=new v(this.tokenManager)}loadMediaEmoji(e,t){if(!Object(o.k)(e))throw new Error("Only supported for media emoji");return this.mediaEmojiCache.loadEmoji(e,t)}optimisticRendering(e,t){const r=t?e.altRepresentation:e.representation;if(!Object(o.l)(r))throw new Error("Only supported for media emoji");const{mediaPath:i}=r;return this.mediaEmojiCache.optimisticRendering(i)}uploadEmoji(e,t){const r=Date.now();return this.tokenManager.getToken("upload").then(i=>{const n=Date.now()-r;return Object(s.a)("upload token load time",n),new Promise((o,a)=>{const{url:c,clientId:u,collectionName:h}=i,d=Object(l.a)({authProvider:()=>Promise.resolve({clientId:u,token:i.jwt,baseUrl:c})}).file.upload({content:e.dataURL,name:e.filename,collection:h}).subscribe({next:i=>{if("uploading"===i.status&&t)t({percent:.95*i.progress});else if("processing"===i.status){d.unsubscribe();const t=Date.now()-r,c=t-n;Object(s.a)("total upload / media upload times",t,c),this.postToEmojiService(e,i.id).then(e=>{o(e)}).catch(e=>{a(e.reason||e)})}},error(e){a(e)}})})})}hasUploadToken(){return this.tokenManager.getToken("upload").then(e=>void 0!==e,()=>!1)}prepareForUpload(){this.tokenManager.getToken("upload")}findEmoji(e){const t="../"+e.id;return Object(a.b)(this.siteServiceConfig,{path:t}).then(e=>Object(a.a)(e).emojis[0]).catch(t=>{Object(s.a)("failed to load emoji",e,t)})}deleteEmoji(e){if(!Object(o.k)(e)&&!Object(o.j)(e))return Promise.reject(!1);const t=""+e.id;return i.utils.requestService(this.siteServiceConfig,{path:t,requestInit:{method:"DELETE"}}).then(()=>!0).catch(()=>!1)}}r.d(t,"b",(function(){return S})),r.d(t,"a",(function(){return O}));const S=e=>{const{isUploadSupported:t,prepareForUpload:r,uploadCustomEmoji:i}=e;return!!(t&&r&&i)};class k extends i.AbstractResource{constructor(e){super(),this.activeLoaders=0,this.retries=new Map,this.isLoaded=()=>0===this.activeLoaders&&this.emojiRepository,this.recordConfig=e.recordConfig,this.currentUser=e.currentUser;const t=[];if(this.activeLoaders=e.providers.length,e.providers.forEach((e,r)=>{new c(e).loadEmoji().then(i=>{t[r]=i,this.initEmojiRepository(t),this.initSiteEmojiResource(i,e).then(()=>{this.activeLoaders--,this.performRetries(),this.refreshLastFilter()})}).catch(e=>{this.activeLoaders--,this.notifyError(e)})}),"undefined"!=typeof window&&window.localStorage&&(this.selectedTone=this.loadStoredTone()),0===e.providers.length)throw new Error("No providers specified")}initEmojiRepository(e){let t=[];e.forEach(e=>{t=t.concat(e.emojis)}),this.emojiRepository=new u.a(t)}initSiteEmojiResource(e,t){if(!this.siteEmojiResource&&e.mediaApiToken){this.siteEmojiResource=new w(t,e.mediaApiToken);const{emojis:r}=e;if(r.length){const e=this.siteEmojiResource.optimisticRendering(r[0]);if(Object(o.n)(e))return e.then(()=>{Object(s.a)("Primed siteEmojiResource")}).catch(()=>{Object(s.a)("Failed to prime siteEmojiResource")});Object(s.a)("Already primed siteEmojiResource")}else Object(s.a)("No emoji to prime siteEmojiResource with")}return Promise.resolve()}performRetries(){const e=this.retries;this.retries=new Map,e.forEach((e,t)=>{const r=t();Object(o.n)(r)?r.then(t=>{e.resolve(t)}).catch(t=>{e.reject(t)}):e.resolve(r)})}loadStoredTone(){const e=window.localStorage.getItem(n.l);if(e){const t=parseInt(e,10);return isNaN(t)?void 0:t}}refreshLastFilter(){if(void 0!==this.lastQuery){const{query:e,options:t}=this.lastQuery;this.filter(e,t)}}retryIfLoading(e,t){return this.isLoaded()?Promise.resolve(t):new Promise((t,r)=>{this.retries.set(e,{resolve:t,reject:r})})}notifyResult(e){this.lastQuery&&e.query===this.lastQuery.query&&super.notifyResult(e)}loadMediaEmoji(e,t){return this.siteEmojiResource&&Object(o.k)(e)?this.siteEmojiResource.loadMediaEmoji(e,t):e}optimisticMediaRendering(e,t){if(!Object(o.k)(e))return!0;if(!this.siteEmojiResource)return!1;const r=this.siteEmojiResource.optimisticRendering(e,t);return!Object(o.n)(r)&&r}filter(e,t){this.lastQuery={query:e,options:t},this.emojiRepository?this.notifyResult(this.emojiRepository.search(e,t)):this.notifyNotReady()}findByShortName(e){return this.isLoaded()?this.emojiRepository.findByShortName(e):this.retryIfLoading(()=>this.findByShortName(e),void 0)}findByEmojiId(e){const{id:t,shortName:r}=e;if(this.emojiRepository){if(!t)return this.findByShortName(r);{const i=this.emojiRepository.findById(t);if(i)return i;if(this.isLoaded())return this.siteEmojiResource?this.siteEmojiResource.findEmoji(e).then(e=>e?(this.addUnknownEmoji(e),e):this.findByShortName(r)):this.findByShortName(r)}}return this.retryIfLoading(()=>this.findByEmojiId(e),void 0)}findById(e){return this.isLoaded()?this.emojiRepository.findById(e):this.retryIfLoading(()=>this.findById(e),void 0)}findInCategory(e){return this.isLoaded()?Promise.resolve(this.emojiRepository.findInCategory(e)):this.retryIfLoading(()=>this.findInCategory(e),[])}getAsciiMap(){return this.isLoaded()?Promise.resolve(this.emojiRepository.getAsciiMap()):this.retryIfLoading(()=>this.getAsciiMap(),new Map)}getFrequentlyUsed(e){return this.isLoaded()?Promise.resolve(this.emojiRepository.getFrequentlyUsed(e)):this.retryIfLoading(()=>this.getFrequentlyUsed(e),[])}recordSelection(e){const{recordConfig:t}=this;if(this.emojiRepository&&this.emojiRepository.used(e),t){const r={emojiId:Object(o.q)(e)},n={method:"POST"};return i.utils.requestService(t,{queryParams:r,requestInit:n})}return Promise.resolve()}deleteSiteEmoji(e){return this.siteEmojiResource&&e.id?this.siteEmojiResource.deleteEmoji(e).then(t=>!(!t||!this.emojiRepository)&&(this.emojiRepository.delete(e),!0)).catch(e=>(console.error("failed to delete site emoji",e),!1)):this.retryIfLoading(()=>this.deleteSiteEmoji(e),!1)}getSelectedTone(){return this.selectedTone}setSelectedTone(e){if(this.selectedTone=e,window.localStorage)try{window.localStorage.setItem(n.l,e?e.toString():"")}catch(t){console.error("failed to store selected emoji skin tone",t)}}calculateDynamicCategories(){return this.isLoaded()?Promise.resolve(this.emojiRepository.getDynamicCategoryList()):this.retryIfLoading(()=>this.calculateDynamicCategories(),[])}getCurrentUser(){return this.currentUser}addUnknownEmoji(e){this.emojiRepository&&this.emojiRepository.addUnknownEmoji(e)}}class O extends k{constructor(e){super(e),this.allowUpload=!!e.allowUpload}isUploadSupported(){return this.allowUpload?this.siteEmojiResource?this.siteEmojiResource.hasUploadToken():this.retryIfLoading(()=>this.isUploadSupported(),!1):Promise.resolve(!1)}uploadCustomEmoji(e){return this.isUploadSupported().then(t=>t&&this.siteEmojiResource?this.siteEmojiResource.uploadEmoji(e).then(e=>(this.addUnknownEmoji(e),this.refreshLastFilter(),e)):Promise.reject("No media api support is configured"))}prepareForUpload(){return this.siteEmojiResource&&this.siteEmojiResource.prepareForUpload(),this.retryIfLoading(()=>this.prepareForUpload(),void 0)}}},"VB+a":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}();t.CaseSensitiveSanitizer=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return i(e,[{key:"sanitize",value:function(e){return e?e.trim():""}}]),e}()},aNTK:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Search=void 0;var i,n=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),o=r("2Vsb"),s=(i=o)&&i.__esModule?i:{default:i},a=r("Dl3+"),c=r("BQ5h"),u=r("eOXs"),h=r("7NDX");t.Search=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!t)throw Error("js-search requires a uid field name constructor parameter");this._uidFieldName=t,this._indexStrategy=new a.PrefixIndexStrategy,this._searchIndex=new u.TfIdfSearchIndex(t),this._sanitizer=new c.LowerCaseSanitizer,this._tokenizer=new h.SimpleTokenizer,this._documents=[],this._searchableFields=[]}return n(e,[{key:"addDocument",value:function(e){this.addDocuments([e])}},{key:"addDocuments",value:function(e){this._documents=this._documents.concat(e),this.indexDocuments_(e,this._searchableFields)}},{key:"addIndex",value:function(e){this._searchableFields.push(e),this.indexDocuments_(this._documents,[e])}},{key:"search",value:function(e){var t=this._tokenizer.tokenize(this._sanitizer.sanitize(e));return this._searchIndex.search(t,this._documents)}},{key:"indexDocuments_",value:function(e,t){this._initialized=!0;for(var r=this._indexStrategy,i=this._sanitizer,n=this._searchIndex,o=this._tokenizer,a=this._uidFieldName,c=0,u=e.length;c<u;c++){var h,d=e[c];h=a instanceof Array?(0,s.default)(d,a):d[a];for(var l=0,m=t.length;l<m;l++){var f,p=t[l];if(null!=(f=p instanceof Array?(0,s.default)(d,p):d[p])&&"string"!=typeof f&&f.toString&&(f=f.toString()),"string"==typeof f)for(var g=o.tokenize(i.sanitize(f)),y=0,b=g.length;y<b;y++)for(var v=g[y],j=r.expandToken(v),w=0,S=j.length;w<S;w++){var k=j[w];n.indexDocument(k,h,d)}}}}},{key:"indexStrategy",set:function(e){if(this._initialized)throw Error("IIndexStrategy cannot be set after initialization");this._indexStrategy=e},get:function(){return this._indexStrategy}},{key:"sanitizer",set:function(e){if(this._initialized)throw Error("ISanitizer cannot be set after initialization");this._sanitizer=e},get:function(){return this._sanitizer}},{key:"searchIndex",set:function(e){if(this._initialized)throw Error("ISearchIndex cannot be set after initialization");this._searchIndex=e},get:function(){return this._searchIndex}},{key:"tokenizer",set:function(e){if(this._initialized)throw Error("ITokenizer cannot be set after initialization");this._tokenizer=e},get:function(){return this._tokenizer}}]),e}()},bb35:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}();t.ExactWordIndexStrategy=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return i(e,[{key:"expandToken",value:function(e){return e?[e]:[]}}]),e}()},eOXs:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r("qmmM");Object.defineProperty(t,"TfIdfSearchIndex",{enumerable:!0,get:function(){return i.TfIdfSearchIndex}});var n=r("+SJH");Object.defineProperty(t,"UnorderedSearchIndex",{enumerable:!0,get:function(){return n.UnorderedSearchIndex}})},qmmM:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TfIdfSearchIndex=void 0;var i,n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),s=r("2Vsb"),a=(i=s)&&i.__esModule?i:{default:i};t.TfIdfSearchIndex=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._uidFieldName=t,this._tokenToIdfCache={},this._tokenMap={}}return o(e,[{key:"indexDocument",value:function(e,t,r){this._tokenToIdfCache={};var i,o=this._tokenMap;"object"!==n(o[e])?o[e]=i={$numDocumentOccurrences:0,$totalNumOccurrences:1,$uidMap:{}}:(i=o[e]).$totalNumOccurrences++;var s=i.$uidMap;"object"!==n(s[t])?(i.$numDocumentOccurrences++,s[t]={$document:r,$numTokenOccurrences:1}):s[t].$numTokenOccurrences++}},{key:"search",value:function(e,t){for(var r={},i=0,o=e.length;i<o;i++){var s=e[i],a=this._tokenMap[s];if(!a)return[];if(0===i)for(var c=0,u=(h=Object.keys(a.$uidMap)).length;c<u;c++){r[d=h[c]]=a.$uidMap[d].$document}else{var h;for(c=0,u=(h=Object.keys(r)).length;c<u;c++){var d=h[c];"object"!==n(a.$uidMap[d])&&delete r[d]}}}var l=[];for(var d in r)l.push(r[d]);var m=this._createCalculateTfIdf();return l.sort((function(r,i){return m(e,i,t)-m(e,r,t)}))}},{key:"_createCalculateIdf",value:function(){var e=this._tokenMap,t=this._tokenToIdfCache;return function(r,i){if(!t[r]){var n=void 0!==e[r]?e[r].$numDocumentOccurrences:0;t[r]=1+Math.log(i.length/(1+n))}return t[r]}}},{key:"_createCalculateTfIdf",value:function(){var e=this._tokenMap,t=this._uidFieldName,r=this._createCalculateIdf();return function(i,n,o){for(var s=0,c=0,u=i.length;c<u;++c){var h,d=i[c],l=r(d,o);l===1/0&&(l=0),h=t instanceof Array?n&&(0,a.default)(n,t):n&&n[t],s+=(void 0!==e[d]&&void 0!==e[d].$uidMap[h]?e[d].$uidMap[h].$numTokenOccurrences:0)*l}return s}}}]),e}()},sWty:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r("Dl3+");Object.defineProperty(t,"AllSubstringsIndexStrategy",{enumerable:!0,get:function(){return i.AllSubstringsIndexStrategy}}),Object.defineProperty(t,"ExactWordIndexStrategy",{enumerable:!0,get:function(){return i.ExactWordIndexStrategy}}),Object.defineProperty(t,"PrefixIndexStrategy",{enumerable:!0,get:function(){return i.PrefixIndexStrategy}});var n=r("BQ5h");Object.defineProperty(t,"CaseSensitiveSanitizer",{enumerable:!0,get:function(){return n.CaseSensitiveSanitizer}}),Object.defineProperty(t,"LowerCaseSanitizer",{enumerable:!0,get:function(){return n.LowerCaseSanitizer}});var o=r("eOXs");Object.defineProperty(t,"TfIdfSearchIndex",{enumerable:!0,get:function(){return o.TfIdfSearchIndex}}),Object.defineProperty(t,"UnorderedSearchIndex",{enumerable:!0,get:function(){return o.UnorderedSearchIndex}});var s=r("7NDX");Object.defineProperty(t,"SimpleTokenizer",{enumerable:!0,get:function(){return s.SimpleTokenizer}}),Object.defineProperty(t,"StemmingTokenizer",{enumerable:!0,get:function(){return s.StemmingTokenizer}}),Object.defineProperty(t,"StopWordsTokenizer",{enumerable:!0,get:function(){return s.StopWordsTokenizer}});var a=r("aNTK");Object.defineProperty(t,"Search",{enumerable:!0,get:function(){return a.Search}});var c=r("HUcV");Object.defineProperty(t,"StopWordsMap",{enumerable:!0,get:function(){return c.StopWordsMap}});var u=r("Fga3");Object.defineProperty(t,"TokenHighlighter",{enumerable:!0,get:function(){return u.TokenHighlighter}})},v7rN:function(e,t,r){"use strict";var i=r("sWty"),n=r("IGfZ"),o=r("mjri"),s=r("ox06");const a=new RegExp("[⺀-⺙⺛-⻳⼀-⿕々〇〡-〩〸-〻㐀-䶵一-鿯豈-舘並-龎]|[A-Za-zªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽͿΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԯԱ-Ֆՙՠ-ֈא-תׯ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࡠ-ࡪࢠ-ࢴࢶ-ࢽऄ-हऽॐक़-ॡॱ-ঀঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱৼਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡૹଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-హఽౘ-ౚౠౡಀಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൔ-ൖൟ-ൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏽᏸ-ᏽᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛱ-ᛸᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡸᢀ-ᢄᢇ-ᢨᢪᢰ-ᣵᤀ-ᤞᥐ-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᲀ-ᲈᲐ-ᲺᲽ-Ჿᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎↃↄⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々〆〱-〵〻〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄯㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿯ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚝꚠ-ꛥꜗ-ꜟꜢ-ꞈꞋ-ꞹꟷ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꣽꣾꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꧠ-ꧤꧦ-ꧯꧺ-ꧾꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꩾ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꬰ-ꭚꭜ-ꭥꭰ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ|0-9²³¹¼-¾٠-٩۰-۹߀-߉०-९০-৯৴-৹੦-੯૦-૯୦-୯୲-୷௦-௲౦-౯౸-౾೦-೯൘-൞൦-൸෦-෯๐-๙໐-໙༠-༳၀-၉႐-႙፩-፼ᛮ-ᛰ០-៩៰-៹᠐-᠙᥆-᥏᧐-᧚᪀-᪉᪐-᪙᭐-᭙᮰-᮹᱀-᱉᱐-᱙⁰⁴-⁹₀-₉⅐-ↂↅ-↉①-⒛⓪-⓿❶-➓⳽〇〡-〩〸-〺㆒-㆕㈠-㈩㉈-㉏㉑-㉟㊀-㊉㊱-㊿꘠-꘩ꛦ-ꛯ꠰-꠵꣐-꣙꤀-꤉꧐-꧙꧰-꧹꩐-꩙꯰-꯹０-９]+[̀-ͯ҃-֑҇-ׇֽֿׁׂׅׄؐ-ًؚ-ٰٟۖ-ۜ۟-۪ۤۧۨ-ܑۭܰ-݊ަ-ް߫-߽߳ࠖ-࠙ࠛ-ࠣࠥ-ࠧࠩ-࡙࠭-࡛࣓-ࣣ࣡-ंऺ़ु-ै्॑-ॗॢॣঁ়ু-ৄ্ৢৣ৾ਁਂ਼ੁੂੇੈੋ-੍ੑੰੱੵઁં઼ુ-ૅેૈ્ૢૣૺ-૿ଁ଼ିୁ-ୄ୍ୖୢୣஂீ்ఀఄా-ీె-ైొ-్ౕౖౢౣಁ಼ಿೆೌ್ೢೣഀഁ഻഼ു-ൄ്ൢൣ්ි-ුූัิ-ฺ็-๎ັິ-ູົຼ່-ໍཱ༹༘༙༵༷-ཾྀ-྄྆྇ྍ-ྗྙ-ྼ࿆ိ-ူဲ-့္်ွှၘၙၞ-ၠၱ-ၴႂႅႆႍႝ፝-፟ᜒ-᜔ᜲ-᜴ᝒᝓᝲᝳ឴឵ិ-ួំ៉-៓៝᠋-᠍ᢅᢆᢩᤠ-ᤢᤧᤨᤲ᤹-᤻ᨘᨗᨛᩖᩘ-ᩞ᩠ᩢᩥ-ᩬᩳ-᩿᩼᪰-᪽ᬀ-ᬃ᬴ᬶ-ᬺᬼᭂ᭫-᭳ᮀᮁᮢ-ᮥᮨᮩ᮫-ᮭ᯦ᯨᯩᯭᯯ-ᯱᰬ-ᰳᰶ᰷᳐-᳔᳒-᳢᳠-᳨᳭᳴᳸᳹᷀-᷹᷻-᷿⃐-⃥⃜⃡-⃰⳯-⵿⳱ⷠ-〪ⷿ-゙゚〭꙯ꙴ-꙽ꚞꚟ꛰꛱ꠂ꠆ꠋꠥꠦ꣄ꣅ꣠-꣱ꣿꤦ-꤭ꥇ-ꥑꦀ-ꦂ꦳ꦶ-ꦹꦼꧥꨩ-ꨮꨱꨲꨵꨶꩃꩌꩼꪰꪲ-ꪴꪷꪸꪾ꪿꫁ꫬꫭ꫶ꯥꯨ꯭ﬞ︀-️︠-︯|']*[A-Za-zªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽͿΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԯԱ-Ֆՙՠ-ֈא-תׯ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࡠ-ࡪࢠ-ࢴࢶ-ࢽऄ-हऽॐक़-ॡॱ-ঀঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱৼਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡૹଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-హఽౘ-ౚౠౡಀಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൔ-ൖൟ-ൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏽᏸ-ᏽᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛱ-ᛸᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡸᢀ-ᢄᢇ-ᢨᢪᢰ-ᣵᤀ-ᤞᥐ-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᲀ-ᲈᲐ-ᲺᲽ-Ჿᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎↃↄⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々〆〱-〵〻〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄯㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿯ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚝꚠ-ꛥꜗ-ꜟꜢ-ꞈꞋ-ꞹꟷ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꣽꣾꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꧠ-ꧤꧦ-ꧯꧺ-ꧾꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꩾ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꬰ-ꭚꭜ-ꭥꭰ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ]*","gi");class c{constructor(...e){this.chain=e}compare(e,t){for(let r=0;r<this.chain.length;r++){const i=this.chain[r].compare(e,t);if(0!==i)return i}return 0}}class u{constructor(e){this.query=e}compare(e,t){const r=e.ascii&&-1!==e.ascii.indexOf(this.query),i=t.ascii&&-1!==t.ascii.indexOf(this.query);return r&&!i?-1:!r&&i?1:0}}class h{constructor(e){this.colonQuery=`:${e}:`,this.typeComparator=new d(!0)}compare(e,t){return e.shortName===this.colonQuery&&t.shortName===this.colonQuery?this.typeComparator.compare(e,t):e.shortName===this.colonQuery?-1:t.shortName===this.colonQuery?1:0}}class d{constructor(e){this.typeToNumber=e?new Map([["SITE",0],["ATLASSIAN",1],["STANDARD",2]]):new Map([["STANDARD",0],["ATLASSIAN",1],["SITE",2]])}compare(e,t){return this.emojiTypeToOrdinal(e)-this.emojiTypeToOrdinal(t)}emojiTypeToOrdinal(e){let t=this.typeToNumber.get(e.type);return void 0===t&&(t=10),t}}class l{constructor(e){this.positionLookup=new Map,e.map((e,t)=>this.positionLookup.set(e,t+1))}compare(e,t){if(!e.id||!t.id)return 0;return this.getPositionInOrder(e)-this.getPositionInOrder(t)}getPositionInOrder(e){let t=e.id?e.id:"0";Object(o.h)(e)&&(t=e.baseId);const r=this.positionLookup.get(t);return r||n.a}}class m{constructor(e,t){if(this.query=e,!t)throw new Error("propertyToCompare is required");this.propertyName=t}getScore(e){const t=e[this.propertyName],r=t?t.indexOf(this.query):n.a;return-1===r?n.a:r}compare(e,t){return this.getScore(e)-this.getScore(t)}}class f{constructor(){}static get Instance(){return this.INSTANCE||(this.INSTANCE=new this)}compare(e,t){return(e.order?e.order:n.a)-(t.order?t.order:n.a)}}class p{constructor(){}static get Instance(){return this.INSTANCE||(this.INSTANCE=new this)}compare(e,t){return e.shortName.localeCompare(t.shortName)}}var g=r("Czhu");class y{constructor(e){if(e.maxDuplicates<1)throw new RangeError("The maxDuplicates option must be at least 1");if(e.minUniqueItems<1)throw new RangeError("The minUniqueItems option must be at least 1");this.maximumSize=e.maxDuplicates*e.minUniqueItems,this.perItemSize=e.maxDuplicates,this.createEmptyState()}enqueue(e){this.enqueueWithoutOrdering(e),this.itemsOrderedByFrequency=this.orderItemsByFrequency()}getItemsOrderedByDuplicateCount(){return this.itemsOrderedByFrequency}clear(){this.createEmptyState()}bulkEnqueue(e){e.map(e=>this.enqueueWithoutOrdering(e)),this.itemsOrderedByFrequency=this.orderItemsByFrequency()}getItems(){return this.items}createEmptyState(){this.items=new Array,this.itemCountMap=new Map,this.itemsOrderedByFrequency=new Array}enqueueWithoutOrdering(e){const t=this.itemCountMap.get(e);t&&t>=this.perItemSize?this.removeFirstOccurrence(e):this.items.length>=this.maximumSize&&this.remove(),this.add(e)}orderItemsByFrequency(){return Array.from(this.itemCountMap.entries()).sort((e,t)=>t[1]-e[1]).map(e=>e[0])}decrementCount(e){let t=this.itemCountMap.get(e);t&&(t--,t>0?this.itemCountMap.set(e,t):this.itemCountMap.delete(e))}removeFirstOccurrence(e){const t=this.items.indexOf(e);-1!==t&&(this.items.splice(t,1),this.decrementCount(e))}remove(){const e=this.items.shift();return void 0!==e&&this.decrementCount(e),e}add(e){this.items.push(e);const t=this.itemCountMap.get(e);t?this.itemCountMap.set(e,t+1):this.itemCountMap.set(e,1)}}var b=r("NubX");class v extends y{constructor(e){super(e),this.storage=e.storage,this.prefixedStorageKey=`${e.storagePrefix}.${v.storageKey}`,this.load()}enqueue(e){super.enqueue(e),this.save()}clear(){super.clear(),this.storage.removeItem(this.prefixedStorageKey)}load(){const e=this.storage.getItem(this.prefixedStorageKey);if(e)try{const t=JSON.parse(e);this.bulkEnqueue(t)}catch(t){Object(b.a)(`Error parsing the queue stored as ${this.prefixedStorageKey} key from storage`,t)}}save(){const e=JSON.stringify(this.getItems());try{this.storage.setItem(this.prefixedStorageKey,e)}catch(t){Object(b.a)("Error saving the queued items as "+this.prefixedStorageKey,t)}}}v.storageKey="lastUsed";class j{constructor(e=!0){const t=j.queueOptions;if(e&&t.storage){const e=Object(g.a)(Object(g.a)({},t),{},{storage:t.storage});this.queue=new v(e)}else this.queue=new y(t);this.gateway=new w(10)}recordUsage(e){let t=e.id;t&&(Object(o.h)(e)&&(t=e.baseId),this.gateway.submit(()=>{t&&this.queue.enqueue(t)}))}getOrder(){return this.queue.getItemsOrderedByDuplicateCount()}clear(){this.queue.clear()}}j.queueOptions={storage:"undefined"!=typeof window&&window.localStorage,storagePrefix:n.k,maxDuplicates:25,minUniqueItems:5};class w{constructor(e){if(e<1)throw new RangeError("The maximumPermitted parameter must be 1 or more.");this.maximumPermitted=e,this.count=0}submit(e){if(this.count>=this.maximumPermitted)return!1;this.count++;return window.setTimeout(()=>{try{e()}finally{this.completed()}}),!0}completed(){this.count--}}r.d(t,"b",(function(){return I})),r.d(t,"a",(function(){return T}));class S{tokenize(e){return this.tokenizeAsTokens(e).map(e=>e.token)}tokenizeAsTokens(e){let t,r=[];for(a.lastIndex=0;null!==(t=a.exec(e));)t[0]&&r.push({token:t[0],start:t.index});return r}}const k=(e,t,r)=>{const i=t(e);r.has(i)||r.set(i,[]);const n=r.get(i);if(n&&n.push(e),Object(o.g)(e)){const i=e.skinVariations;i&&i.forEach(e=>k(e,t,r))}},O=(e,t)=>{const r=e.get(t);if(r&&r.length)return r[r.length-1]},I=(e,t)=>{if(Object(o.g)(e)&&t){const r=t.skinTone;if(r&&e.skinVariations&&e.skinVariations.length){const t=e.skinVariations[r-1];if(t)return t}}return e};class T{constructor(e,t){this.emojis=e,this.initMembers(t)}all(){const e={sort:s.a.None};return this.search("",e)}search(e,t){let r=[];const{nameQuery:i,asciiQuery:n}=((e="")=>0===e.indexOf(":")?{nameQuery:e.slice(1),asciiQuery:e}:{nameQuery:e,asciiQuery:""})(e);return i?(r=this.fullSearch.search(i),n&&(r=this.withAsciiMatch(n,r))):r=this.getAllSearchableEmojis(),r=this.applySearchOptions(r,e,t),{emojis:r,query:e}}findAllMatchingShortName(e){return this.shortNameMap.get(e)||[]}findByShortName(e){return O(this.shortNameMap,e)}findById(e){return O(this.idMap,e)}findByAsciiRepresentation(e){return this.asciiMap.get(e)}findInCategory(e){return e===n.j?this.getFrequentlyUsed():this.all().emojis.filter(t=>t.category===e)}addUnknownEmoji(e){this.emojis=[...this.emojis,e],this.fullSearch.addDocuments([e]),this.addToMaps(e),this.addToDynamicCategories(e)}getAsciiMap(){return this.asciiMap}getFrequentlyUsed(e){let t=this.usageTracker.getOrder().map(e=>this.findById(e)).filter(e=>void 0!==e);return e&&(t=this.applySearchOptions(t,"",e)),t}getDynamicCategoryList(){return this.dynamicCategoryList.slice()}used(e){this.usageTracker.recordUsage(e),-1===this.dynamicCategoryList.indexOf(n.j)&&window.setTimeout(()=>{this.dynamicCategoryList.push(n.j)})}delete(e){const t=((e,t)=>{const r=t.id;let i=-1;return e.forEach((e,n)=>{(e.id&&e.id===r||!e.id&&!r&&e.shortName===t.shortName)&&(i=n)}),i})(this.emojis,e);-1!==t&&(this.emojis.splice(t,1),this.initMembers(this.usageTracker))}withAsciiMatch(e,t){let r=t;const i=this.findByAsciiRepresentation(e);return i&&(r=t.filter(e=>e.id!==i.id),r=[i,...r]),r}applySearchOptions(e,t,r){let i;return r||(r={}),void 0===r.sort&&(r.sort=s.a.Default),r.sort===s.a.Default?i=function(e,t){const r=e?e.replace(/:/g,"").toLowerCase().trim():void 0,i=[];e&&i.push(new u(e)),r&&i.push(new h(r)),t&&t.length&&i.push(new l(t)),r&&i.push(new m(r,"shortName"),new m(r,"name")),i.push(f.Instance,p.Instance);const n=new c(...i);return n.compare=n.compare.bind(n),n}(t,this.usageTracker.getOrder()):r.sort===s.a.UsageFrequency&&(i=function(e){const t=new c(new l(e),new d,f.Instance);return t.compare=t.compare.bind(t),t}(this.usageTracker.getOrder())),i&&(i.compare=i.compare.bind(i),e=e.sort(i.compare)),r.limit&&r.limit>0&&(e=e.slice(0,r.limit)),r.skinTone?e.map(e=>I(e,r)):e}initMembers(e){this.usageTracker=e||new j,this.initRepositoryMetadata(),this.initSearchIndex()}initRepositoryMetadata(){this.shortNameMap=new Map,this.idMap=new Map,this.asciiMap=new Map;const e=new Set;this.emojis.forEach(t=>{e.add(t.category),this.addToMaps(t)}),this.usageTracker.getOrder().length&&e.add(n.j),this.dynamicCategoryList=Array.from(e).filter(e=>-1===n.e.indexOf(e))}initSearchIndex(){this.fullSearch=new i.Search("id"),this.fullSearch.tokenizer=new S,this.fullSearch.searchIndex=new i.UnorderedSearchIndex,this.fullSearch.addIndex("name"),this.fullSearch.addIndex("shortName"),this.fullSearch.addDocuments(this.getAllSearchableEmojis())}getAllSearchableEmojis(){return this.emojis.filter(e=>e.searchable)}addToMaps(e){void 0!==e.order&&-1!==e.order||(e.order=T.defaultEmojiWeight),void 0===e.id&&(e.id=T.defaultEmojiWeight.toString()),k(e,e=>e.shortName,this.shortNameMap),k(e,e=>e.id,this.idMap),e.ascii&&e.ascii.forEach(t=>this.asciiMap.set(t,e))}addToDynamicCategories(e){const t=Object(o.e)(e);-1===n.e.indexOf(t)&&-1===this.dynamicCategoryList.indexOf(t)&&this.dynamicCategoryList.push(t)}}T.defaultEmojiWeight=1e6},"xew/":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StopWordsTokenizer=void 0;var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),n=r("HUcV");t.StopWordsTokenizer=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._tokenizer=t}return i(e,[{key:"tokenize",value:function(e){return this._tokenizer.tokenize(e).filter((function(e){return!n.StopWordsMap[e]}))}}]),e}()}}]);
//# sourceMappingURL=20.6XHHkSijf9.js.map
