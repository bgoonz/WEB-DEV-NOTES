(window.webpackJsonp=window.webpackJsonp||[]).push([["content-renderer~dc51bad7"],{"/MSF":function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return i}));var a=n("EfWO"),r=n("ERkP"),s=n.n(r),o=n("L21V");const c="https://support.atlassian.com/contact/#/",i=({showHostname:e,children:t})=>s.a.createElement("a",{href:c,target:"_blank"},s.a.Children.count(t)?t:(e=>e?Object(a.parse)(c).hostname:s.a.createElement(o.b,{id:"error-boundary.description.support-link",description:"The text of the link which will lead the user to the Atlassian Support web site",defaultMessage:"Atlassian Support"},e=>e))(e))},"8ghD":function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return o}));var a=n("Czhu");function r(e){return e.type.name||e.type}function s(e,t){return{type:r(e),attrs:Object(a.a)(Object(a.a)({},e.attrs),{},{parameters:Object(a.a)(Object(a.a)({},e.attrs.parameters),t)})}}function o(e,t){const n=[];return function e(t,n){for(const a of Object.keys(t)){const r=t[a];n(a,r),null!==r&&"object"==typeof r&&e(t[a],n)}}(e,(e,a)=>{a&&a.type===t&&n.push(a)}),n}},D3Yu:function(e,t,n){"use strict";var a=n("zjfJ"),r=n("lZoD");n.d(t,"a",(function(){return s}));class s extends r.a{constructor(...e){super(...e),Object(a.a)(this,"state",{ready:null,permissions:{}}),Object(a.a)(this,"setReady",e=>{this.setNewState(1,e)}),Object(a.a)(this,"setNoPermission",e=>{this.setNewState(2,e)}),Object(a.a)(this,"setNotFound",e=>{this.setNewState(3,e)}),Object(a.a)(this,"setError",e=>{this.setNewState(4,e)}),Object(a.a)(this,"reset",e=>{this.setNewState(null,e)}),Object(a.a)(this,"setPermissions",e=>{this.state.permissions=this.checkPermissions(e)})}setNewState(e,t){this.setState({ready:e,permissions:this.checkPermissions(t)})}checkPermissions(e){return void 0===e?this.state.permissions:null===e?{}:e}}},KuFb:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n("7+Q0");const r={[a.b.DEFAULT]:"full-page",[a.b.FULL_WIDTH]:"full-width"},s=e=>{const t=r[e];return t||o()},o=()=>r[a.b.DEFAULT]},Licu:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n("H5qd"),r=n.n(a),s=n("j+hl");const o=r.a`query ContentRendererQuery($contentId:ID$status:[String]){content(id:$contentId status:$status){nodes{id body{atlas_doc_format{value}}space{id key}type ...contentAppearancePublishedFragment}}}${s.b}`},M2LZ:function(e,t,n){"use strict";var a=n("S2j0");var r={require:(e,t)=>new Promise(n=>{Object(a.a)(e,e=>{n(e),t&&t(e)},()=>{0})})},s=n("zjfJ"),o=n("Czhu"),c=n("ERkP"),i=n.n(c);var u=function(e,t){const n=Object(o.a)({isBlocking:!0},t);return t=>{class r extends c.Component{constructor(...e){super(...e),Object(s.a)(this,"state",{dependenciesLoaded:!1}),Object(s.a)(this,"markAsLoaded",()=>{this.mounted&&this.setState({dependenciesLoaded:!0})})}componentDidMount(){this.mounted=!0,e&&e.length>0?Object(a.a)(e,this.markAsLoaded,()=>{0}):this.markAsLoaded()}componentWillUnmount(){this.mounted=!1}render(){const{dependenciesLoaded:e}=this.state;return e||!n.isBlocking?i.a.createElement(t,Object(o.a)(Object(o.a)({},this.props),{},{wrmDependenciesLoaded:e})):null}}return r.displayName=`WRMComponent(${t.displayName||t.name})`,r}};n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return u}))},MV18:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n("ERkP"),r=n("6z9Z");function s({name:e,attributes:t}){const n=Object(a.useContext)(r.a);return Object(a.useEffect)(()=>n.succeed({name:e,attributes:t}),[e,t,n]),null}},"Q//X":function(e,t,n){"use strict";n.d(t,"c",(function(){return m})),n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return f})),n.d(t,"e",(function(){return y})),n.d(t,"g",(function(){return k})),n.d(t,"i",(function(){return _})),n.d(t,"h",(function(){return T})),n.d(t,"f",(function(){return S})),n.d(t,"d",(function(){return $}));var a=n("HbGN"),r=n("Czhu"),s=n("lSUb"),o=n("3VMZ"),c=n("A79P"),i=n("hpu0"),u=n("9btq"),l=n("bw/P"),d=n("cld1"),b=n("iB1A");const m="renderer",p="editor",f="confluence.frontend.macro.analytics.tracker",h="taskSuccess",O="taskFail",g="taskAbort",j="taskStart",A=e=>e.split(".").slice(1).join("."),E=(e=new Map)=>{const t=[];for(const n of e.values()){const{name:e}=n;if(e!==o.a.VIEW_ALL_MACRO){const a=Object(r.a)({uniqueHash:A(e)},I(n));t.push(a)}}return t},y=e=>{var t,n,a;return{type:(null!=(a=e)?a.type:a)||"",macroId:Object(b.c)(null!=(n=e)?n.parameters:n),extensionKey:Object(b.b)(e),extensionType:(null!=(t=e)?t.extensionType:t)||""}},I=e=>{var t,n,a,r,s,o,c;return{extensionKey:Object(b.b)(null!=(c=e)?c.experienceAttributes:c),extensionType:(null!=(o=e)&&null!=(o=o.experienceAttributes)?o.extensionType:o)||"",type:(null!=(s=e)&&null!=(s=s.experienceAttributes)?s.type:s)||"",macroId:(null!=(r=e)&&null!=(r=r.experienceAttributes)?r.macroId:r)||"",duration:(null!=(a=e)?a.duration:a)||"",status:(null!=(n=e)?n.status:n)||"",pageId:(null!=(t=e)?t.pageId:t)||""}},k=(e,t)=>{x(e,t).has(t)||S(e,t).start({attributes:{mode:e},name:o.a.VIEW_ALL_MACRO,timeout:c.a.MACRO_LOAD,id:t})},_=(e,t)=>{const n=x(e,t);if(n.has(t)){if(M(n)){const t={mode:e,macros:null};w(n)&&(t.macros=E(n)),Object(i.b)().succeed({name:o.a.VIEW_ALL_MACRO,attributes:Object(r.a)({},t)})}else Object(i.b)().abort({name:o.a.VIEW_ALL_MACRO,reason:`Some macro aborted before completion in ${c.a.MACRO_LOAD}ms`,attributes:{macros:E(n),mode:e}});v(n).forEach(t=>{const n=Object(b.b)(t.experienceAttributes),a=t.status;Object(d.getAnalyticsWebClient)().then(s=>{s.sendOperationalEvent({source:"ui",actionSubject:"macroTracker",action:a,attributes:Object(r.a)(Object(r.a)({},t.experienceAttributes),{},{extensionKey:n,mode:e,task:""+o.a.VIEW_JIRA_MACRO})})})}),n.clear(),R.set(`${e}.${t}`,n)}},M=(e=new Map)=>{if(0===e.size)return!0;for(const t of e.values())if(t.name!==o.a.VIEW_ALL_MACRO&&t.status!==h)return!1;return!0},w=(e=new Map)=>{for(const t of e.values())if(t.name!==o.a.VIEW_ALL_MACRO)return!0;return!1},C=e=>e.includes(b.a),v=e=>{const t=[];for(const n of e.values())C(n.name)&&t.push(n);return t},L=(e,t)=>{!function n(){setTimeout(()=>{const a=x(t,e);if(!a.has(e))return;const s=a.get(e),u=Math.round(window.performance.now()-s.startTime)>c.a.MACRO_LOAD;if(M(a)&&w(a))Object(i.b)().succeed({name:o.a.VIEW_ALL_MACRO,attributes:{macros:E(a),mode:t}});else if(u){if(w(a)){Object(i.b)().abort({name:o.a.VIEW_ALL_MACRO,reason:`Some macro aborted before completion in ${c.a.MACRO_LOAD}ms`,attributes:{macros:E(a),mode:t}});(e=>{const t=[];for(const n of e.values())C(n.name)&&n.status!==h&&t.push(n);return t})(a).forEach(e=>{const n=Object(b.b)(e.experienceAttributes);Object(d.getAnalyticsWebClient)().then(a=>{a.sendOperationalEvent({source:"ui",actionSubject:"macroTracker",action:"taskAbort",attributes:Object(r.a)(Object(r.a)({},e.experienceAttributes),{},{extensionKey:n,mode:t,task:""+o.a.VIEW_JIRA_MACRO,reason:`JIRA macro aborted before completion in ${c.a.MACRO_LOAD}ms`})})})})}else Object(i.b)().succeed({name:o.a.VIEW_ALL_MACRO,attributes:{mode:t}});a.clear(),R.set(`${t}.${e}`,a)}else n()},2e3)}()},R=new Map,x=(e,t)=>(R.has(`${e}.${t}`)||R.set(`${e}.${t}`,new Map),R.get(`${e}.${t}`)),T=(e,t,n,a)=>{var s;const i=x(e,t),l=null!=(s=a)?s.macroId:s;if(i.has(l)&&C(n)){const t=Object(b.b)(a),{status:n}=i.get(l);if(n===h){const{duration:n}=i.get(l);Object(d.getAnalyticsWebClient)().then(s=>{s.sendOperationalEvent({source:"ui",actionSubject:"macroTracker",action:"taskSuccess",attributes:Object(r.a)(Object(r.a)({},a),{},{extensionKey:t,mode:e,duration:n,task:""+o.a.VIEW_JIRA_MACRO})})})}else if(n===g){const{duration:n}=i.get(l);Object(d.getAnalyticsWebClient)().then(s=>{s.sendOperationalEvent({source:"ui",actionSubject:"macroTracker",action:"taskAbort",attributes:Object(r.a)(Object(r.a)({},a),{},{extensionKey:t,mode:e,duration:n,task:""+o.a.VIEW_JIRA_MACRO,reason:`JIRA macro aborted before completion in ${c.a.MACRO_LOAD}ms`})})})}else if(n===O){const{duration:n}=i.get(l);Object(d.getAnalyticsWebClient)().then(s=>{s.sendOperationalEvent({source:"ui",actionSubject:"macroTracker",action:"taskFail",attributes:Object(r.a)(Object(r.a)({},a),{},{extensionKey:t,mode:e,duration:n,task:""+o.a.VIEW_JIRA_MACRO,error:new u.a(`JIRA macro failed to complete in ${c.a.MACRO_LOAD}ms`)})})})}}},S=Object(s.default)((e,t)=>{const n=new l.a,s=x(e,t);return n.subscribe(n=>{var u;const{action:l,name:m,attributes:p}=n,f=Object(a.a)(n,["action","name","attributes"]),A=null!=(u=p)?u.macroId:u;if(l===j){const n=s.get(A);if(n&&n.id===A)return;m===o.a.VIEW_ALL_MACRO?s.has(t)||(s.clear(),Object(i.b)().start({name:o.a.VIEW_ALL_MACRO,timeout:c.a.MACRO_LOAD,id:t,attributes:{mode:e}}),s.set(t,Object(r.a)({status:j,name:m,mode:e},f)),R.set(`${e}.${t}`,s)):(s.set(A,Object(r.a)({status:j,name:m,experienceAttributes:Object(r.a)(Object(r.a)({},p),{},{extensionKey:Object(b.b)(p)}),pageId:t,mode:e},f)),((e,t,n,a)=>{if(C(n)){const n=Object(b.b)(a);Object(d.getAnalyticsWebClient)().then(s=>{s.sendOperationalEvent({source:"ui",actionSubject:"macroTracker",action:"taskStart",attributes:Object(r.a)(Object(r.a)({},a),{},{extensionKey:n,mode:e,pageId:t,task:""+o.a.VIEW_JIRA_MACRO})})})}})(e,t,m,p))}else if(l===h){if(!s.has(A))return;const{duration:a,name:o}=n;s.set(A,Object(r.a)(Object(r.a)({},s.get(A)),{},{id:A,name:o,mode:e,status:h,duration:a,pageId:t})),R.set(`${e}.${t}`,s),T(e,t,o,p)}else if(l===g){if(!s.has(A))return;const{duration:a,reason:c,name:u}=n;s.set(A,Object(r.a)(Object(r.a)({},s.get(A)),{},{id:A,name:u,mode:e,status:g,duration:a,pageId:t,reason:c})),R.set(`${e}.${t}`,s),Object(i.b)().abort({name:o.a.VIEW_ALL_MACRO,reason:"Macro abort loading",attributes:{macros:E(s),mode:e}}),T(e,t,u,p)}else if(l==O){if(!s.has(A))return;const{duration:a,error:c,name:u}=n;s.set(A,Object(r.a)(Object(r.a)({},s.get(A)),{},{id:A,name:u,mode:e,status:O,duration:a,pageId:t,error:c})),R.set(`${e}.${t}`,s),Object(i.b)().fail({name:o.a.VIEW_ALL_MACRO,error:c,attributes:{macros:E(s),mode:e}}),T(e,t,u,p)}L(t,e)}),n}),$=(e,t)=>{const n=y(t);return`${e}.${Object(b.b)(n)}.${n.macroId}`}},U7xr:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n("RfuI");const r=Object(a.a)({id:"YJqem",name:"DeepLinkHandler",loader:async()=>(await n.e("deep-link-handler~8b1a6a8a").then(n.bind(null,"p4JA"))).DeepLinkHandler})},YVdS:function(e,t,n){"use strict";n.r(t);var a=n("1U1M"),r=n("ERkP"),s=n.n(r),o=n("lZoD"),c=n("FdGg"),i=n("X2PC"),u=n("qhEF"),l=n("D3Yu"),d=n("cGYM"),b=n("H5qd"),m=n.n(b),p=n("j+hl");const f=m.a`query ContentRendererExternalQuery($contentId:ID!$externalToken:String!){sharedContent(contentId:$contentId shareToken:$externalToken){content{id body{atlas_doc_format{value}}type ...contentAppearancePublishedFragment}}}${p.b}`;var h=n("Licu"),O=n("adTp"),g=n("zjfJ"),j=n("L21V"),A=n("KsTJ"),E=n("lbXe"),y=n("KuFb"),I=n("U7xr"),k=n("/MSF"),_=n("Q//X"),M=n("KIs4"),w=n("U63R"),C=n("aiom"),v=n("Oa+u"),L=n("8YYk"),R=n("8ghD"),x=n("RfuI"),T=Object(x.a)({id:"LJYVE",name:"packages/confluence-fabric-editor/src/components/MediaViewer/index.ts",loader:()=>n.e("fabric.media.viewer~dc51bad7").then(n.bind(null,"LFDX"))}),S=n("JpXc"),$=n("M2LZ");const W=["wr!com.atlassian.confluence.plugins.confluence-jira-content:confluence-jira-content-loader","wr!com.atlassian.confluence.plugins.confluence-view-file-macro:view-file-macro-resources","wr!confluence.web.resources:view-content","wr!com.atlassian.confluence.plugins.confluence-inline-tasks:inline-tasks-styles"];const D=A.default.div`
  padding-bottom: 10px;
`,F=A.default.pre`
  white-space: normal;
  border: 1px solid #dddddd;
  padding-left: 10px;
  margin-top: 0;
  width: 300px;
  height: 48px;
  overflow-y: scroll;
`,V={margin:"auto"},N=e=>Object(R.a)(e,"media").map(({attrs:e})=>({align:"center",id:e.id,mediaItemType:e.type,collectionName:e.collection})),P=(e,t,n)=>()=>{const a=t&&"#"===t[0]&&t.length>1?t.slice(1):null;return s.a.createElement(r.Fragment,null,s.a.createElement(v.a,{contentId:e,isNextRendered:!1,fabric:!0}),n&&a?s.a.createElement(I.a,{scrollTargetId:a,refOfNodeToWatchForChange:n}):null)},J=Object(E.a)()(Object(j.g)(class extends r.PureComponent{constructor(...e){super(...e),Object(g.a)(this,"refOfNodeToWatchForChange",s.a.createRef())}componentDidMount(){const{contentId:e}=this.props;if(this.props.adfError){this.props.createAnalyticsEvent({type:"sendTrackEvent",data:{action:"error",actionSubject:"adf.parsing.error",source:"contentRendererComponent",attributes:{errorMessage:this.props.adfError}}}).fire();!1?this.props.flags.showErrorFlag(this._getStagingErrorText(this.props.adfError)):this.props.flags.showErrorFlag(this._getProductionErrorText())}setTimeout(()=>{$.a.require(W),this.props.contentStateSetReady()},0),Object(_.g)(_.c,e)}componentWillUnmount(){const{contentId:e}=this.props;Object(_.i)(_.c,e)}_getProductionErrorText(){return{title:this.props.intl.formatMessage({id:"adf.translation.error.in.render.title.prod",defaultMessage:"Error displaying content"}),description:s.a.createElement("div",{dangerouslySetInnerHTML:{__html:this.props.intl.formatMessage({id:"adf.translation.error.in.render.description.prod",defaultMessage:'Refresh the page and try again. If the problem persists, contact <a target="_blank" href="{link}">Atlassian Support</a>.'},{link:k.a})}})}}_getStagingErrorText(e){return{title:this.props.intl.formatMessage({id:"adf.translation.error.in.render.title.staging",defaultMessage:"Error displaying content"}),description:s.a.createElement(r.Fragment,null,s.a.createElement(D,{dangerouslySetInnerHTML:{__html:this.props.intl.formatMessage({id:"adf.translation.error.in.render.description.staging",defaultMessage:'An ADF error is preventing your content from being displayed. Discuss further in the <a target="_blank" href="{link}">#cc-content-experience</a> Slack channel.'},{link:"https://atlassian.slack.com/messages/CFGRZK3MF"})}}),s.a.createElement(j.b,{id:"editor.adf.parsing.error.details"}),s.a.createElement(F,null,e))}}renderMediaViewer(){const{adf:e,contentId:t}=this.props;return t&&e?s.a.createElement(T,{parentId:t,media:N(e)}):null}render(){window.performance.mark("CFP-63.view.page.classic.contentrenderer.rendered");const{adf:e,contentId:t,contentType:n,spaceKey:a,appearance:r,scrollTo:o}=this.props;return t&&e?s.a.createElement(M.a,null,({featureFlags:c})=>{const i=!c["confluence.frontend.fabric.editor.disable.dynamic-text-resizing"],u=Object(y.a)(r);return s.a.createElement("div",{id:"content",className:"page view",ref:this.refOfNodeToWatchForChange},s.a.createElement(C.a,{anchorContainer:this.refOfNodeToWatchForChange}),s.a.createElement(L.b,null,s.a.createElement(S.b,{priority:w.a.IMMEDIATE,id:"main-content",allowInlineComments:!0,allowHighlightActions:!0,className:c["confluence.frontend.remove-wiki-content"]?"":"wiki-content",allowDynamicTextSizing:i,appearance:u,style:V,adf:e,objectId:t,contentType:n,spaceKey:a,renderWhenReady:P(t,o,this.refOfNodeToWatchForChange)})),this.renderMediaViewer())}):null}})),K=s.a.memo(e=>{var t,n,r,b,m;const{contentId:p,scrollTo:g,data:j,externalToken:A}=e,E=Object(a.d)(A?f:h.a,{skip:!!j,context:{single:!0,contentId:p,allowOnExternalPage:!0},variables:{contentId:p,externalToken:A},fetchPolicy:"cache-and-network"});if(E.error)throw E.error;const y=j||E.data,I=j||!A?null!=(m=y)&&null!=(m=m.content)&&null!=(m=m.nodes)?m[0]:m:null!=(b=y)&&null!=(b=b.sharedContent)?b.content:b;if(!I)return null;const k=j?null!=(r=I)&&null!=(r=r.body)&&null!=(r=r.dynamic)?r.value:r:null!=(n=I)&&null!=(n=n.body)&&null!=(n=n.atlas_doc_format)?n.value:n,{adf:_,adfError:M}=(e=>{try{return{adf:JSON.parse(e)}}catch(t){return console.error("Invalid adf document",t),{adfError:Object(d.a)(t.stack).toString()}}})(k),w=null!=(t=I)&&null!=(t=t.space)?t.key:t,C=I.type,v=Object(O.e)(I).appearance;return s.a.createElement(c.a,{attribution:i.a.CONTENT_EXPERIENCE},s.a.createElement(o.c,{to:[u.a,l.a]},(e,{setReady:t})=>s.a.createElement(J,{flags:e,adf:_,adfError:M,scrollTo:g,contentId:p,contentType:C,spaceKey:w,contentStateSetReady:t,appearance:v})))});t.default=K},iB1A:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return i}));var a=n("Z9L/"),r=n("IC1n"),s=n.n(r);const o="jira",c=e=>{var t;if(!e)return s()();const n=null!=(t=e)&&null!=(t=t.macroMetadata)&&null!=(t=t.macroId)?t.value:t;return n||Object(a.a)(e)},i=e=>{var t;if(!e)return"";const{extensionKey:n}=e,a=null!=(t=e)&&null!=(t=t.parameters)?t.macroParams:t;return n===o?`${n}${u(a)}`:n},u=e=>{var t,n,a,r;return"true"===(null!=(r=e)&&null!=(r=r.count)?r.value:r)?"-issue-count":(null!=(a=e)?a.columns:a)&&(null!=(n=e)?n.maximumIssues:n)?"-table-view":(null!=(t=e)&&null!=(t=t.key)?t.value:t)?"-single-issue":""}}}]);
//# sourceMappingURL=content-renderer~dc51bad7.KKvWRx8aii.js.map