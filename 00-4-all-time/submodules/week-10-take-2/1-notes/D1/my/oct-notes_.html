<!DOCTYPE html><html><head>
      <title>oct-notes_</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
      <link rel="stylesheet" href="file:///c:\Users\bryan\.vscode\extensions\shd101wyy.markdown-preview-enhanced-0.5.13\node_modules\@shd101wyy\mume\dependencies\katex\katex.min.css">
      
      
      
      
      
      
      
      
      
      <style>
      /**
 * prism.js Github theme based on GitHub's theme.
 * @author Sam Clarke
 */
code[class*="language-"],
pre[class*="language-"] {
  color: #333;
  background: none;
  font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.4;

  -moz-tab-size: 8;
  -o-tab-size: 8;
  tab-size: 8;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

/* Code blocks */
pre[class*="language-"] {
  padding: .8em;
  overflow: auto;
  /* border: 1px solid #ddd; */
  border-radius: 3px;
  /* background: #fff; */
  background: #f5f5f5;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
  padding: .1em;
  border-radius: .3em;
  white-space: normal;
  background: #f5f5f5;
}

.token.comment,
.token.blockquote {
  color: #969896;
}

.token.cdata {
  color: #183691;
}

.token.doctype,
.token.punctuation,
.token.variable,
.token.macro.property {
  color: #333;
}

.token.operator,
.token.important,
.token.keyword,
.token.rule,
.token.builtin {
  color: #a71d5d;
}

.token.string,
.token.url,
.token.regex,
.token.attr-value {
  color: #183691;
}

.token.property,
.token.number,
.token.boolean,
.token.entity,
.token.atrule,
.token.constant,
.token.symbol,
.token.command,
.token.code {
  color: #0086b3;
}

.token.tag,
.token.selector,
.token.prolog {
  color: #63a35c;
}

.token.function,
.token.namespace,
.token.pseudo-element,
.token.class,
.token.class-name,
.token.pseudo-class,
.token.id,
.token.url-reference .token.variable,
.token.attr-name {
  color: #795da3;
}

.token.entity {
  cursor: help;
}

.token.title,
.token.title .token.punctuation {
  font-weight: bold;
  color: #1d3e81;
}

.token.list {
  color: #ed6a43;
}

.token.inserted {
  background-color: #eaffea;
  color: #55a532;
}

.token.deleted {
  background-color: #ffecec;
  color: #bd2c00;
}

.token.bold {
  font-weight: bold;
}

.token.italic {
  font-style: italic;
}


/* JSON */
.language-json .token.property {
  color: #183691;
}

.language-markup .token.tag .token.punctuation {
  color: #333;
}

/* CSS */
code.language-css,
.language-css .token.function {
  color: #0086b3;
}

/* YAML */
.language-yaml .token.atrule {
  color: #63a35c;
}

code.language-yaml {
  color: #183691;
}

/* Ruby */
.language-ruby .token.function {
  color: #333;
}

/* Markdown */
.language-markdown .token.url {
  color: #795da3;
}

/* Makefile */
.language-makefile .token.symbol {
  color: #795da3;
}

.language-makefile .token.variable {
  color: #183691;
}

.language-makefile .token.builtin {
  color: #0086b3;
}

/* Bash */
.language-bash .token.keyword {
  color: #0086b3;
}

/* highlight */
pre[data-line] {
  position: relative;
  padding: 1em 0 1em 3em;
}
pre[data-line] .line-highlight-wrapper {
  position: absolute;
  top: 0;
  left: 0;
  background-color: transparent;
  display: block;
  width: 100%;
}

pre[data-line] .line-highlight {
  position: absolute;
  left: 0;
  right: 0;
  padding: inherit 0;
  margin-top: 1em;
  background: hsla(24, 20%, 50%,.08);
  background: linear-gradient(to right, hsla(24, 20%, 50%,.1) 70%, hsla(24, 20%, 50%,0));
  pointer-events: none;
  line-height: inherit;
  white-space: pre;
}

pre[data-line] .line-highlight:before, 
pre[data-line] .line-highlight[data-end]:after {
  content: attr(data-start);
  position: absolute;
  top: .4em;
  left: .6em;
  min-width: 1em;
  padding: 0 .5em;
  background-color: hsla(24, 20%, 50%,.4);
  color: hsl(24, 20%, 95%);
  font: bold 65%/1.5 sans-serif;
  text-align: center;
  vertical-align: .3em;
  border-radius: 999px;
  text-shadow: none;
  box-shadow: 0 1px white;
}

pre[data-line] .line-highlight[data-end]:after {
  content: attr(data-end);
  top: auto;
  bottom: .4em;
}html body{font-family:"Helvetica Neue",Helvetica,"Segoe UI",Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#333;background-color:#fff;overflow:initial;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#000}html body h1{font-size:2.25em;font-weight:300;padding-bottom:.3em}html body h2{font-size:1.75em;font-weight:400;padding-bottom:.3em}html body h3{font-size:1.5em;font-weight:500}html body h4{font-size:1.25em;font-weight:600}html body h5{font-size:1.1em;font-weight:600}html body h6{font-size:1em;font-weight:600}html body h1,html body h2,html body h3,html body h4,html body h5{font-weight:600}html body h5{font-size:1em}html body h6{color:#5c5c5c}html body strong{color:#000}html body del{color:#5c5c5c}html body a:not([href]){color:inherit;text-decoration:none}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body img{max-width:100%}html body>p{margin-top:0;margin-bottom:16px;word-wrap:break-word}html body>ul,html body>ol{margin-bottom:16px}html body ul,html body ol{padding-left:2em}html body ul.no-list,html body ol.no-list{padding:0;list-style-type:none}html body ul ul,html body ul ol,html body ol ol,html body ol ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li.task-list-item{list-style:none}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox{margin:0 .2em .25em -1.8em;vertical-align:middle}html body .task-list-item-checkbox:hover{cursor:pointer}html body blockquote{margin:16px 0;font-size:inherit;padding:0 15px;color:#5c5c5c;background-color:#f0f0f0;border-left:4px solid #d6d6d6}html body blockquote>:first-child{margin-top:0}html body blockquote>:last-child{margin-bottom:0}html body hr{height:4px;margin:32px 0;background-color:#d6d6d6;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}html body table th{font-weight:bold;color:#000}html body table td,html body table th{border:1px solid #d6d6d6;padding:6px 13px}html body dl{padding:0}html body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:bold}html body dl dd{padding:0 16px;margin-bottom:16px}html body code{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;font-size:.85em !important;color:#000;background-color:#f0f0f0;border-radius:3px;padding:.2em 0}html body code::before,html body code::after{letter-spacing:-0.2em;content:"\00a0"}html body pre>code{padding:0;margin:0;font-size:.85em !important;word-break:normal;white-space:pre;background:transparent;border:0}html body .highlight{margin-bottom:16px}html body .highlight pre,html body pre{padding:1em;overflow:auto;font-size:.85em !important;line-height:1.45;border:#d6d6d6;border-radius:3px}html body .highlight pre{margin-bottom:0;word-break:normal}html body pre code,html body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:before,html body pre tt:before,html body pre code:after,html body pre tt:after{content:normal}html body p,html body blockquote,html body ul,html body ol,html body dl,html body pre{margin-top:0;margin-bottom:16px}html body kbd{color:#000;border:1px solid #d6d6d6;border-bottom:2px solid #c7c7c7;padding:2px 4px;background-color:#f0f0f0;border-radius:3px}@media print{html body{background-color:#fff}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{color:#000;page-break-after:avoid}html body blockquote{color:#5c5c5c}html body pre{page-break-inside:avoid}html body table{display:table}html body img{display:block;max-width:100%;max-height:100%}html body pre,html body code{word-wrap:break-word;white-space:pre}}.markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview .pagebreak,.markdown-preview .newpage{page-break-before:always}.markdown-preview pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}.markdown-preview pre.line-numbers>code{position:relative}.markdown-preview pre.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:0;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-preview pre.line-numbers .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.markdown-preview .mathjax-exps .MathJax_Display{text-align:center !important}.markdown-preview:not([for="preview"]) .code-chunk .btn-group{display:none}.markdown-preview:not([for="preview"]) .code-chunk .status{display:none}.markdown-preview:not([for="preview"]) .code-chunk .output-div{margin-bottom:16px}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0}@media screen and (min-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px + 2em)}}@media screen and (max-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{font-size:14px !important;padding:1em}}@media print{html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{display:none}}html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{position:fixed;bottom:8px;left:8px;font-size:28px;cursor:pointer;color:inherit;z-index:99;width:32px;text-align:center;opacity:.4}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn{opacity:1}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc{position:fixed;top:0;left:0;width:300px;height:100%;padding:32px 0 48px 0;font-size:14px;box-shadow:0 0 4px rgba(150,150,150,0.33);box-sizing:border-box;overflow:auto;background-color:inherit}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a{text-decoration:none}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc ul{padding:0 1.6em;margin-top:.8em}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc li{margin-bottom:.8em}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc ul{list-style-type:none}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{left:300px;width:calc(100% -  300px);padding:2em calc(50% - 457px -  150px);margin:0;box-sizing:border-box}@media screen and (max-width:1274px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{width:100%}}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc{display:none}

      </style>
    </head>
    <body for="html-export">
      <div class="mume markdown-preview  ">
      <h2>RDBMS</h2>
<p>That&apos;s quite an ugly acronym, but it&apos;s what developers have when referring to the software application that manages databases for us. Here&apos;s an important difference for you to understand.</p>
<p>The <strong>RDBMS</strong> is a software application that you run that your programs can connect to that they can store, modify, and retrieve data. The RDBS that you will use in this course is called <a href="https://www.postgresql.org/">PostgreSQL</a>, often shortened to just &quot;postgres&quot;, pronounced like it&apos;s spelled. It is an &quot;open-source&quot; RDBMS which means that you can go read the source code for it, copy it, modify it, and make your own specialized version of an RDBMS. Often, developers will talk about the &quot;database server&quot;. That is the computer on which the RDBMS is running.</p>
<p>A <strong>database</strong> (or more properly <strong>relational database</strong>) is a collection of structured data that the RDBMS manages for you. A single running RDBMS can have hundreds of databases in it that it manages.</p>
<h2>What is PostgreSQL?</h2>
<p>Again, PostgreSQL is software. Specifically, it is an open-source, relational database management system. It is derived from the POSTGRES package written at UC Berkeley. The specific name &quot;PostgreSQL&quot; was coined in 1996, after SQL was implemented as its core query language. PostgreSQL provided a new program (new for 1996) for interactive SQL queries called <code>[psql]</code>, which is terminal-based front-end to PostgreSQL that lets you to type in queries interactively, issue them to PostgreSQL, and see the query results.</p>
<p>When you do connect with it, you will interact with it through a small set of its own commands and SQL.</p>
<h2>What is SQL?</h2>
<p>SQL (pronounced &quot;sequel&quot; or &quot;s-q-l&quot;) stands for &quot;Structured Query Language&quot;. It is not a programming language like JavaScript. JavaScript, as you well know, has <em>control flow</em>, with <code>for</code> loops and <code>if</code> statements. Most SQL that you write doesn&apos;t have all that. Instead, it is a <em>declarative</em> programming language. You tell the database what computation you want it to do, and it does it.</p>
<p>The process of using SQL takes two steps:</p>
<ol>
<li>Connect to an RDBMS specifying
<ul>
<li>credentials, user name and password</li>
<li>the name of the database that you want to use</li>
</ul>
</li>
<li>Issue one or more SQL statements to interact with
<ul>
<li>the structure of the database</li>
<li>the data in the database</li>
</ul>
</li>
</ol>
<p><img src="../../../images/d6dd08f78245c1f7457c496ea32e5b77b17fc2a8833ad0e5a1cdfe80b35625cb.png" alt="picture 1"></p>
<p><img src="../../../images/3478b7ec074d124ae526af81d6bd9004aeb327e05cda3109b8e8d2c8898d464b.png" alt="picture 3"></p>
<p><img src="../../../images/b88352a2c178ba56345aa1aa703e8ef4d88c749f5e0cf79637432937d38957ed.png" alt="picture 4"></p>
<p><img src="../../../images/4e8c7f13c392a3da81b27d80c1703a846ea5bb35c9c9902802c8630483173f04.png" alt="picture 5"></p>
<p><img src="../../../images/adac702051e62b3729cfe9869845fb17a1ecc53ce86bf47cca529fc2edd1ebeb.png" alt="picture 6"></p>
<p><img src="../../../images/0ac1ccca984a5620243123d810386a9093e141eeb9a0b65cae1ce27152437f9e.png" alt="picture 7"></p>
<p><img src="../../../images/c754280a7ea24ff9b7fa20c88b4c5c0b0515be3677f0785f400bc190f8953819.png" alt="picture 8"></p>
<p><img src="../../../images/f493a0c7771e6ebb8a53908ee2a9953451d5648e9875af6f650db54b6c91471d.png" alt="picture 9"></p>
<h2 class="mume-header" id="psql">PSQL</h2>

<p>Magic words:</p>
<pre data-role="codeBlock" data-info="bash" class="language-bash">psql -U postgres
</pre><p>Some interesting flags (to see all, use <code>-h</code> or <code>--help</code> depending on your psql version):</p>
<ul>
<li><code>-E</code>: will describe the underlaying queries of the <code>\</code> commands (cool for learning!)</li>
<li><code>-l</code>: psql will list all databases and then exit (useful if the user you connect with doesn&apos;t has a default database, like at AWS RDS)</li>
</ul>
<p>Most <code>\d</code> commands support additional param of <code>__schema__.name__</code> and accept wildcards like <code>*.*</code></p>
<ul>
<li><code>\q</code>: Quit/Exit</li>
<li><code>\c __database__</code>: Connect to a database</li>
<li><code>\d __table__</code>: Show table definition (columns, etc.) including triggers</li>
<li><code>\d+ __table__</code>: More detailed table definition including description and physical disk size</li>
<li><code>\l</code>: List databases</li>
<li><code>\dy</code>: List events</li>
<li><code>\df</code>: List functions</li>
<li><code>\di</code>: List indexes</li>
<li><code>\dn</code>: List schemas</li>
<li><code>\dt *.*</code>: List tables from all schemas (if <code>*.*</code> is omitted will only show SEARCH_PATH ones)</li>
<li><code>\dT+</code>: List all data types</li>
<li><code>\dv</code>: List views</li>
<li><code>\dx</code>: List all extensions installed</li>
<li><code>\df+ __function__</code> : Show function SQL code.</li>
<li><code>\x</code>: Pretty-format query results instead of the not-so-useful ASCII tables</li>
<li><code>\copy (SELECT * FROM __table_name__) TO &apos;file_path_and_name.csv&apos; WITH CSV</code>: Export a table as CSV</li>
<li><code>\des+</code>: List all foreign servers</li>
<li><code>\dE[S+]</code>: List all foreign tables</li>
</ul>
<p>User Related:</p>
<ul>
<li><code>\du</code>: List users</li>
<li><code>\du __username__</code>: List a username if present.</li>
<li><code>create role __test1__</code>: Create a role with an existing username.</li>
<li><code>create role __test2__ noinherit login password __passsword__;</code>: Create a role with username and password.</li>
<li><code>set role __test__;</code>: Change role for current session to <code>__test__</code>.</li>
<li><code>grant __test2__ to __test1__;</code>: Allow <code>__test1__</code> to set its role as <code>__test2__</code>.</li>
<li><code>\deu+</code>: List all user mapping on server</li>
</ul>
<h2 class="mume-header" id="configuration">Configuration</h2>

<ul>
<li>Service management commands:</li>
</ul>
<pre data-role="codeBlock" data-info class="language-"><code>sudo service postgresql stop
sudo service postgresql start
sudo service postgresql restart
</code></pre><ul>
<li>Changing verbosity &amp; querying Postgres log:<br>
<br>1) First edit the config file, set a decent verbosity, save and restart postgres:</li>
</ul>
<pre data-role="codeBlock" data-info class="language-"><code>sudo vim /etc/postgresql/9.3/main/postgresql.conf
  
# Uncomment/Change inside:
log_min_messages = debug5
log_min_error_statement = debug5
log_min_duration_statement = -1
  
sudo service postgresql restart
</code></pre><ol start="2">
<li>Now you will get tons of details of every statement, error, and even background tasks like VACUUMs</li>
</ol>
<pre data-role="codeBlock" data-info class="language-"><code>tail -f /var/log/postgresql/postgresql-9.3-main.log
</code></pre><ol start="3">
<li>How to add user who executed a PG statement to log (editing <code>postgresql.conf</code>):</li>
</ol>
<pre data-role="codeBlock" data-info class="language-"><code>log_line_prefix = &apos;%t %u %d %a &apos;
</code></pre><h2 class="mume-header" id="create-command">Create command</h2>

<p>There are many <code>CREATE</code> choices, like <code>CREATE DATABASE __database_name__</code>, <code>CREATE TABLE __table_name__</code> ... Parameters differ but can be checked <a href="https://www.postgresql.org/search/?u=%2Fdocs%2F9.1%2F&amp;q=CREATE">at the official documentation</a>.</p>
<h2 class="mume-header" id="handy-queries">Handy queries</h2>

<ul>
<li><code>SELECT * FROM pg_proc WHERE proname=&apos;__procedurename__&apos;</code>: List procedure/function</li>
<li><code>SELECT * FROM pg_views WHERE viewname=&apos;__viewname__&apos;;</code>: List view (including the definition)</li>
<li><code>SELECT pg_size_pretty(pg_total_relation_size(&apos;__table_name__&apos;));</code>: Show DB table space in use</li>
<li><code>SELECT pg_size_pretty(pg_database_size(&apos;__database_name__&apos;));</code>: Show DB space in use</li>
<li><code>show statement_timeout;</code>: Show current user&apos;s statement timeout</li>
<li><code>SELECT * FROM pg_indexes WHERE tablename=&apos;__table_name__&apos; AND schemaname=&apos;__schema_name__&apos;;</code>: Show table indexes</li>
<li>Get all indexes from all tables of a schema:</li>
</ul>
<pre data-role="codeBlock" data-info="sql" class="language-sql"><span class="token keyword">SELECT</span>
   t<span class="token punctuation">.</span>relname <span class="token keyword">AS</span> table_name<span class="token punctuation">,</span>
   i<span class="token punctuation">.</span>relname <span class="token keyword">AS</span> index_name<span class="token punctuation">,</span>
   a<span class="token punctuation">.</span>attname <span class="token keyword">AS</span> column_name
<span class="token keyword">FROM</span>
   pg_class t<span class="token punctuation">,</span>
   pg_class i<span class="token punctuation">,</span>
   pg_index ix<span class="token punctuation">,</span>
   pg_attribute a<span class="token punctuation">,</span>
    pg_namespace n
<span class="token keyword">WHERE</span>
   t<span class="token punctuation">.</span>oid <span class="token operator">=</span> ix<span class="token punctuation">.</span>indrelid
   <span class="token operator">AND</span> i<span class="token punctuation">.</span>oid <span class="token operator">=</span> ix<span class="token punctuation">.</span>indexrelid
   <span class="token operator">AND</span> a<span class="token punctuation">.</span>attrelid <span class="token operator">=</span> t<span class="token punctuation">.</span>oid
   <span class="token operator">AND</span> a<span class="token punctuation">.</span>attnum <span class="token operator">=</span> <span class="token keyword">ANY</span><span class="token punctuation">(</span>ix<span class="token punctuation">.</span>indkey<span class="token punctuation">)</span>
   <span class="token operator">AND</span> t<span class="token punctuation">.</span>relnamespace <span class="token operator">=</span> n<span class="token punctuation">.</span>oid
    <span class="token operator">AND</span> n<span class="token punctuation">.</span>nspname <span class="token operator">=</span> <span class="token string">&apos;kartones&apos;</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span>
   t<span class="token punctuation">.</span>relname<span class="token punctuation">,</span>
   i<span class="token punctuation">.</span>relname
</pre><ul>
<li>Execution data:
<ul>
<li>Queries being executed at a certain DB:</li>
</ul>
</li>
</ul>
<pre data-role="codeBlock" data-info="sql" class="language-sql"><span class="token keyword">SELECT</span> datname<span class="token punctuation">,</span> application_name<span class="token punctuation">,</span> pid<span class="token punctuation">,</span> backend_start<span class="token punctuation">,</span> query_start<span class="token punctuation">,</span> state_change<span class="token punctuation">,</span> state<span class="token punctuation">,</span> query
  <span class="token keyword">FROM</span> pg_stat_activity
  <span class="token keyword">WHERE</span> datname<span class="token operator">=</span><span class="token string">&apos;__database_name__&apos;</span><span class="token punctuation">;</span>
</pre><ul>
<li>Get all queries from all dbs waiting for data (might be hung):</li>
</ul>
<pre data-role="codeBlock" data-info="sql" class="language-sql"><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> pg_stat_activity <span class="token keyword">WHERE</span> waiting<span class="token operator">=</span><span class="token string">&apos;t&apos;</span>
</pre><ul>
<li>Currently running queries with process pid:</li>
</ul>
<pre data-role="codeBlock" data-info="sql" class="language-sql"><span class="token keyword">SELECT</span> pg_stat_get_backend_pid<span class="token punctuation">(</span>s<span class="token punctuation">.</span>backendid<span class="token punctuation">)</span> <span class="token keyword">AS</span> procpid<span class="token punctuation">,</span>
  pg_stat_get_backend_activity<span class="token punctuation">(</span>s<span class="token punctuation">.</span>backendid<span class="token punctuation">)</span> <span class="token keyword">AS</span> current_query
<span class="token keyword">FROM</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> pg_stat_get_backend_idset<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> backendid<span class="token punctuation">)</span> <span class="token keyword">AS</span> s<span class="token punctuation">;</span>
</pre><p>Casting:</p>
<ul>
<li><code>CAST (column AS type)</code> or <code>column::type</code></li>
<li><code>&apos;__table_name__&apos;::regclass::oid</code>: Get oid having a table name</li>
</ul>
<p>Query analysis:</p>
<ul>
<li><code>EXPLAIN __query__</code>: see the query plan for the given query</li>
<li><code>EXPLAIN ANALYZE __query__</code>: see and execute the query plan for the given query</li>
<li><code>ANALYZE [__table__]</code>: collect statistics</li>
</ul>
<p>Generating random data (<a href="https://www.citusdata.com/blog/2019/07/17/postgres-tips-for-average-and-power-user/">source</a>):</p>
<ul>
<li><code>INSERT INTO some_table (a_float_value) SELECT random() * 100000 FROM generate_series(1, 1000000) i;</code></li>
</ul>
<p><img src="../../../images/10c39b09e6a7df30eeb73d33c1711ad6884315c7c368b6c74478725ae486a23d.png" alt="picture 1"></p>
<p><img src="../../../images/03ab52c85dfafd6033e75ae6b4c3156403f0e65b997edb00fbe7be4fe61d22fa.png" alt="picture 2"></p>
<h2 class="mume-header" id="forign-keys-are-what-make-databases-relationalthey-reference-atable-and-column-in-another-table">Forign keys are what make databases relational...they reference atable and column in another table.</h2>

<p><img src="../../../images/ddfd524fb7f3da3fc3c44ccbef9a74fa7c5e0e1700ff97e4aaec52beb89ce1df.png" alt="picture 3"></p>

      </div>
      <div class="md-sidebar-toc"><ul>
<li><a href="#psql">PSQL</a></li>
<li><a href="#configuration">Configuration</a></li>
<li><a href="#create-command">Create command</a></li>
<li><a href="#handy-queries">Handy queries</a></li>
<li><a href="#forign-keys-are-what-make-databases-relationalthey-reference-atable-and-column-in-another-table">Forign keys are what make databases relational...they reference atable and column in another table.</a></li>
</ul>
</div>
      <a id="sidebar-toc-btn">&#x2261;</a>
    
    
    
    
    
    
    
    
<script>

var sidebarTOCBtn = document.getElementById('sidebar-toc-btn')
sidebarTOCBtn.addEventListener('click', function(event) {
  event.stopPropagation()
  if (document.body.hasAttribute('html-show-sidebar-toc')) {
    document.body.removeAttribute('html-show-sidebar-toc')
  } else {
    document.body.setAttribute('html-show-sidebar-toc', true)
  }
})
</script>
      
  
    </body></html>