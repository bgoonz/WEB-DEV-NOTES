(window.webpackJsonp=window.webpackJsonp||[]).push([["onboarding-state-update~dade3008"],{"29F/":function(e,t,a){"use strict";a.d(t,"i",(function(){return c})),a.d(t,"c",(function(){return r})),a.d(t,"b",(function(){return o})),a.d(t,"h",(function(){return i})),a.d(t,"j",(function(){return l})),a.d(t,"g",(function(){return u})),a.d(t,"d",(function(){return s})),a.d(t,"k",(function(){return d})),a.d(t,"e",(function(){return E})),a.d(t,"a",(function(){return p})),a.d(t,"l",(function(){return b})),a.d(t,"m",(function(){return f})),a.d(t,"f",(function(){return g}));var n=a("Qdol");const c={IS_PANEL_OPEN:"quickstart-state:isPanelOpen",IS_DISMISSED:"quickstart-state:isDismissed",OPEN_TASK_ID:"quickstart-state:openTaskId",OPEN_COMPONENT_ID:"quickstart-state:openComponentId",CREATE_SPACE_COMPLETED:"quickstart-state:createSpaceCompleted",CREATE_PAGE_COMPLETED:"quickstart-state:createPageCompleted",INVITE_TEAMMATE_COMPLETED:"quickstart-state:inviteTeammateCompleted",SHARE_PAGE_COMPLETED:"quickstart-state:sharePageCompleted",INTEGRATION_COMPLETED:"quickstart-state:integrationCompleted",HELP_COMPLETED:"quickstart-state:helpCompleted",SPACE_TOUR_COMPLETED:"quickstart-state:spaceTourCompleted",COLLABORATE_COMPLETED:"quickstart-state:collaborateCompleted",HOME_TOUR_COMPLETED:"quickstart-state:homeTourCompleted",HAS_SEEN_DISMISSED_FLAG:"quickstart-state:hasSeenDismissedFlag"},r="quickstart-checklist.create-space",o="quickstart-checklist.create-page",i="quickstart-checklist.invite-teammate",l="quickstart-checklist.share-page",u="quickstart-checklist.integration",s="quickstart-checklist.help",d="quickstart-checklist.space-tour",E="quickstart-checklist.find-home",p="quickstart-checklist.collaborate",b={[o]:n.d,[i]:n.j},f={[r]:"createSpaceCompleted",[o]:"createPageCompleted",[i]:"inviteTeammateCompleted",[l]:"sharePageCompleted",[u]:"integrationCompleted",[s]:"helpCompleted",[d]:"spaceTourCompleted",[E]:"homeTourCompleted",[p]:"collaborateCompleted"},g=new Set([d,E,p])},WiIw:function(e,t,a){"use strict";var n=a("Czhu"),c=a("ERkP"),r=a.n(c),o=a("a0gl"),i=a("z9P0"),l=a("Qdol"),u=a("aepo"),s=a("TSpG");const{ONBOARDING_NUDGE:d}=s.a,E=({featureFlagClient:e,cloudId:t,locale:a,expList:n=l.f})=>{const c=(({featureFlagClient:e,cloudId:t,locale:a,shouldTrackExposureEvent:n=!1})=>({[d]:Object(u.a)(e,{shouldTrackExposureEvent:n,locale:a,cloudId:t})}))({featureFlagClient:e,cloudId:t,locale:a});return Object.keys(c).filter(e=>c[e]).reduce((e,t)=>e.concat(...n[t]),[]).concat(...l.l)};var p=a("8TdO"),b=a("F4Ur"),f=a("rc7/"),g=a("btRf");const{OVERALL_STATE:k}=l.g,O=async({createAnalyticsEvent:e,skip:t=!1})=>{const a={};if(t)return a;try{const{data:e,loading:t}=await Object(p.b)().query({query:g.a,variables:{key:Object.values(l.g)}});if(t)return a;const{onboardingState:c}=e;if(void 0!==c){var n;const e=(null!=(n=c.find(({key:e})=>e===k))?n.value:n)===l.b;c.forEach(({key:t,value:n})=>{a[t]=n===l.b||e})}}catch(c){y({createAnalyticsEvent:e,type:"sendOperationalEvent",action:"queryFailed",actionSubject:"onboardingData",source:"allOnboardingExp"}),Object(f.b)(c)&&Object(b.a)(c)}return a},m=async({key:e,createAnalyticsEvent:t,eligibleExperiences:a})=>{try{await Object(p.b)().mutate({mutation:g.b,variables:{key:e,value:l.b},refetchQueries:[{query:g.a,variables:{key:Object.values(l.g)}}],awaitRefetchQueries:!0});const n=await O({createAnalyticsEvent:t});v({experiences:n,update:m,key:e,eligibleExperiences:a,createAnalyticsEvent:t}),y({createAnalyticsEvent:t,type:"sendOperationalEvent",action:"updateSucceeded",actionSubject:"onboardingData",source:e})}catch(n){y({createAnalyticsEvent:t,type:"sendOperationalEvent",action:"completionFailed",actionSubject:"onboarding",source:e})}},y=({createAnalyticsEvent:e,type:t,action:a,actionSubject:n,source:c})=>{e({type:t,data:{action:a,actionSubject:n,source:c}}).fire()},v=({experiences:e,update:t,eligibleExperiences:a,key:n,createAnalyticsEvent:c})=>{const r=Object.keys(e).filter(t=>!e[t]).filter(e=>a.includes(e)),o=e[k];n===k||o||o||0!==r.length||t({key:k,createAnalyticsEvent:c,eligibleExperiences:a})};a.d(t,"a",(function(){return C})),a.d(t,"b",(function(){return T}));const C=()=>{const{createAnalyticsEvent:e}=Object(i.a)(),{userId:t,featureFlagClient:a,cloudId:n,locale:r}=Object(o.a)(),u=!t,[s,d]=Object(c.useState)({}),p=E({featureFlagClient:a,cloudId:n,locale:r});Object(c.useEffect)(()=>{(async()=>{const t=await O({skip:u,createAnalyticsEvent:e});d(t)})()},[]);return{experiences:s,overallState:s[l.i],onboardingUpdate:t=>m({key:t,createAnalyticsEvent:e,eligibleExperiences:p})}},T=e=>t=>{const a=C();return r.a.createElement(e,Object(n.a)(Object(n.a)({},t),{},{onboardingData:a}))}},Zn5E:function(e,t,a){"use strict";a.r(t),a.d(t,"FLAGS",(function(){return d})),a.d(t,"OnboardingStateEditor",(function(){return E}));var n=a("ERkP"),c=a.n(n),r=a("1U1M"),o=a("zJ/j"),i=a("kC4U"),l=a("29F/"),u=a("Qdol"),s=a("btRf");const d=[...Object.values(l.i),...Object.values(u.g)],E=()=>{const{data:e,refetch:t}=Object(r.d)(s.a,{variables:{key:d},fetchPolicy:"cache-and-network"});return c.a.createElement("div",null,c.a.createElement("table",null,c.a.createElement("tbody",null,c.a.createElement("tr",{key:"header"},c.a.createElement("th",null,"Experience"),c.a.createElement("th",null,"Value"),c.a.createElement("th",null)),d.map((a,n)=>{var r,l;return c.a.createElement("tr",{key:a},c.a.createElement("td",null,a),c.a.createElement("td",null,(null!=(r=e)&&null!=(r=r.onboardingState)&&null!=(r=r[n])?r.value:r)||null),c.a.createElement("td",null,c.a.createElement(o.a,{onClick:(l=a,async()=>{await Object(i.a)("/wiki/rest/onboarding/1/store",{body:JSON.stringify({key:l}),method:"DELETE",headers:{"Content-Type":"application/json"}}),await t()}),appearance:"link"},"Reset")))}))))}},aepo:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a("bPAi"),c=a("TSpG");const{ONBOARDING_NUDGE:r}=c.a,o=(e,{shouldTrackExposureEvent:t=!0,locale:a,cloudId:c})=>Object(n.a)(r,e,t,a,c)},bPAi:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a("HKB3");const c=(e,t,a=!0,c,r)=>{const o=Object(n.c)(t,e,a);if(o===n.a.ENROLLED)return!0;if(o===n.a.EXPERIMENT){if(t.getBooleanValue("confluence.frontend.onboarding.segment.holdout",{default:!1,shouldTrackExposureEvent:a})&&Object(n.d)(r))return!1;const e=t.getBooleanValue("confluence.frontend.onboarding.segment.en-only",{default:!0,shouldTrackExposureEvent:a}),o=/^en/i.test(c);if(e&&!o)return!1;return Object(n.c)(t,"confluence.frontend.onboarding.segment",a)===n.a.EXPERIMENT}return!1}},btRf:function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return o}));var n=a("H5qd"),c=a.n(n);const r=c.a`query AllOnboardingExpStatus($key:[String]){onboardingState(key:$key){key value}}`,o=c.a`mutation OnboardingStatusUpdateMutation($key:String$value:String)@experimental{experimentalCompleteOnboarding(key:$key value:$value){complete key}}`},cphC:function(e,t,a){"use strict";a.d(t,"a",(function(){return E}));var n=a("Czhu"),c=a("zjfJ"),r=a("ERkP"),o=a.n(r),i=a("fYnN"),l=a.n(i),u=a("C+A9"),s=a("KIs4");const d=()=>{};function E(e){var t,a;return a=t=class extends r.Component{constructor(...e){super(...e),Object(c.a)(this,"isEngagementDisabledForTests",Boolean(l.a.get("confluence.disable-engagement-for-tests")))}render(){return o.a.createElement(s.a,null,({cloudId:t})=>{const a=this.isEngagementDisabledForTests?{start:d,stop:d}:new u.a(t,"/gateway/api");return o.a.createElement(e,Object(n.a)(Object(n.a)({},this.props),{},{coordinationClient:a}))})}},Object(c.a)(t,"displayName",`withCoordinationClient(${e.displayName||e.name})`),a}},ngiW:function(e,t,a){"use strict";a.r(t);var n=a("ERkP"),c=a.n(n),r=a("lbXe"),o=a("a0gl"),i=a("cphC"),l=a("Qdol"),u=a("WiIw"),s=a("TSpG");const{ONBOARDING_STATE_UPDATE_FLAG:d}=s.a;var E=a("lPJD");a.d(t,"OnboardingStateUpdateComponent",(function(){return f}));const{OVERALL_STATE:p}=l.g,b=({onboardingUpdate:e,createAnalyticsEvent:t})=>(Object(n.useEffect)(()=>{e(p),t({type:"sendTrackEvent",data:{name:"onboardingStateUpdated",action:"onboardingStateUpdated",actionSubject:"page",actionSubjectId:"onboardingStateUpdate",source:"onboardingStateUpdate"}}).fire()},[]),null),f=Object(i.a)(Object(r.a)()(({createAnalyticsEvent:e,coordinationClient:t})=>{const{featureFlagClient:a,userId:n}=Object(o.a)(),{onboardingUpdate:r,overallState:i}=Object(u.a)();if(!(e=>e.getBooleanValue(d,{default:!1,shouldTrackExposureEvent:!0}))(a))return null;if(!n)return null;return!i?c.a.createElement(E.a,{client:t,messageId:"confluence-onboarding-state-update"},c.a.createElement(b,{onboardingUpdate:r,createAnalyticsEvent:e})):null}))}}]);
//# sourceMappingURL=onboarding-state-update~dade3008.GnFFnuua2x.js.map