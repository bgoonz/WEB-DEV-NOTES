(window.webpackJsonp=window.webpackJsonp||[]).push([["page.rollout-banner~493df0b3"],{DMQv:function(e,t,n){"use strict";var a=n("ROYt"),c=n("yS9+"),s=n("yLtY"),i=n("Ci1e"),r=n("mWX1");const o={changeSets:new i.schema.Array({user:r.user,recentUpdates:new i.schema.Array(r.content)})},l={results:new i.schema.Array(r.content)},u={resultList:new i.schema.Array(r.content)};n.d(t,"g",(function(){return p})),n.d(t,"a",(function(){return d})),n.d(t,"m",(function(){return h})),n.d(t,"k",(function(){return E})),n.d(t,"b",(function(){return b})),n.d(t,"e",(function(){return m})),n.d(t,"f",(function(){return y})),n.d(t,"d",(function(){return O})),n.d(t,"l",(function(){return f})),n.d(t,"j",(function(){return T})),n.d(t,"c",(function(){return g})),n.d(t,"h",(function(){return C})),n.d(t,"i",(function(){return N})),n.d(t,"n",(function(){return j}));const p=Object(c.c)("SPACE_INFO",a.a.spaces.space,{schema:s.a.spaces}),d=(Object(c.c)("FAVOURITED_SPACES",a.a.spaces.favourited,{schema:s.a.spaces}),Object(c.c)("RECENTLY_VISITED_SPACES",a.a.spaces.recentlyVisited,{schema:s.a.spaces}),Object(c.c)("SPACE_LABELS",a.a.spaces.labels),Object(c.c)("SPACE_FAVOURITE",a.a.spaces.favourite)),h=Object(c.c)("SPACE_UNFAVOURITE",a.a.spaces.unfavourite),E=Object(c.c)("SPACE_HOME_CONTENT",a.a.spaces.spaceHomeContent,{schema:s.a.content}),b=(Object(c.c)("DELETE_ATTACHMENT",a.a.content.deleteContent),Object(c.c)("LABELS",a.a.spaces.labels),Object(c.c)("RECENTLY_UPDATED_CONTENT",a.a.content.recentlyUpdated,{schema:o}),Object(c.c)("POPULAR_CONTENT",a.a.content.popular,{schema:u}),Object(c.c)("DRAFTS_CONTENT",a.a.content.drafts,{schema:l})),m=Object(c.c)("RECENT_WORK_CONTENT",a.a.content.recentlyUpdatedByCurrentUserWithDrafts,{schema:l}),y=Object(c.c)("RECENTLY_VISITED_CONTENT",a.a.content.recentlyVisitedByCurrentUser,{schema:l}),O=Object(c.c)("FAVOURITED_CONTENT",a.a.content.favouritedByCurrentUser,{schema:l}),f=Object(c.c)("UNFAVOURITE_CONTENT",a.a.content.unfavourite),T=(Object(c.c)("SPACE_WATCH_ADD",a.a.watches.add),Object(c.c)("SPACE_WATCH_DELETE",a.a.watches.delete),Object(c.c)("GET_APP_SWITCHER_LINKS",a.a.appSwitcher.getAppSwitcherLinks),Object(c.c)("FEATURE_DISCOVERED_MARK",a.a.featureDiscovery.markDiscovered)),g=(Object(c.c)("FOLLOW_USER",a.a.users.follow,{schema:s.a.user}),Object(c.c)("UNFOLLOW_USER",a.a.users.unfollow,{schema:s.a.user}),Object(c.c)("EDITOR_CONTENT_METADATA",a.a.content.editPageMetadata,{schema:s.a.content})),C=Object(c.c)("SPACE_CALENDAR",a.a.views.spaceCalendar),N=(Object(c.c)("UPDATE_SPACE_LOGO",a.a.spaces.logo,{schema:s.a.space}),Object(c.c)("SPACE_HOME_OVERRIDE_CONTENT",a.a.atlassianConnect.getConnectModuleDescriptor,{schema:s.a.connectModule})),_={RECENTLY_VISITED_CONTENT:a.a.content.recentlyVisitedByCurrentUser,RECENT_WORK_CONTENT:a.a.content.recentlyUpdatedByCurrentUserWithDrafts,FAVOURITED_CONTENT:a.a.content.favouritedByCurrentUser,DRAFTS_CONTENT:a.a.content.drafts};function j(e,t){return Object(c.c)(e,_[e],{schema:l})(t)}Object(c.c)("USER_DARK_FEATURE",a.a.settings.addUserDarkFeature),Object(c.c)("SEND_ANALYTICS",a.a.settings.sendAnalytics)},QJbY:function(e,t,n){"use strict";n.r(t);var a=n("ERkP"),c=n.n(a),s=n("KIs4"),i=n("bQlP"),r=n("gQ5V"),o=n("+mzV"),l=n("uDfI"),u=n("rZXo"),p=n("DMQv"),d=n("OzZX"),h=n("vqZc"),E=n("zjfJ"),b=n("L21V"),m=n("KsTJ"),y=n("lbXe"),O=n("gHio"),f=n.n(O),T=n("lRcl"),g=n("3IV/"),C=n("94Z3"),N=n("kC4U"),_=n("gScn"),j=n("Z/GR"),A=n.n(j);const I=m.default.div`
  display: flex;
  align-items: center;
  justify-content: center;
  min-height: 56px;
  padding: 5px 60px;
  position: relative;
  background-image: url(${A.a});

  ${({backgroundType:e})=>"wavey"===e?`\n      background-color: ${g.B50};\n    `:`\n      background-color: ${g.Y100};\n      background-image: none;\n  `};

  background-position: left bottom;
  background-repeat: repeat-x;
  font-size: 16px;
  text-align: center;
`,D=m.default.div`
  font-size: 24pt;
  margin-right: 10px;
`,k=m.default.div`
  max-width: 800px;
`,S=m.default.span`
  font-weight: bold;
`,M=m.default.span``,v=m.default.span`
  color: ${g.N800};

  a,
  a:link,
  a:visited,
  a:active,
  a:hover {
    text-decoration: underline;
    color: ${g.N800};
    cursor: pointer;
  }
`,R=m.default.div`
  position: absolute;
  right: 10px;
  top: 10px;
  cursor: pointer;
`;class w extends a.Component{constructor(...e){super(...e),Object(E.a)(this,"state",{isCreatingNewPage:!1}),Object(E.a)(this,"_willEventuallyRender",()=>this.props.shouldRender&&("tryit"!==this.props.actionType||this.props.spaceKey)),Object(E.a)(this,"_sendScreenEvent",()=>{this.props.createAnalyticsEvent({type:"sendScreenEvent",data:{name:"fabricRolloutBanner",attributes:{sourceType:this.props.bannerType}}}).fire()}),Object(E.a)(this,"_sendUIEvent",(e,t,n)=>{this.props.createAnalyticsEvent({type:"sendUIEvent",data:{action:e,actionSubject:t,actionSubjectId:n,source:"fabricRolloutBanner",attributes:{sourceType:this.props.bannerType}}}).fire()}),Object(E.a)(this,"_onCloseClick",()=>{this._sendUIEvent("clicked","button","close"),this.props.dismissAnnouncement(this.props.featureDiscoveryKey)}),Object(E.a)(this,"_spinnerOn",()=>{this.setState({isCreatingNewPage:!0})}),Object(E.a)(this,"_spinnerOff",()=>{this.setState({isCreatingNewPage:!1})}),Object(E.a)(this,"_onLearnMoreLinkClick",()=>(this._sendUIEvent("clicked","link","action"),!0)),Object(E.a)(this,"_onTryItLinkClick",()=>{this._spinnerOn(),this._sendUIEvent("clicked","link","action");const e={type:"page",status:"draft",space:{key:this.props.spaceKey},metadata:{properties:{editor:{value:"v2"}}}},t=e=>{if(e instanceof C.a)return e.response;throw e};Object(N.a)("/wiki/rest/api/content",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).catch(t).then(e=>e.json()).then(e=>e._links.editui).then(e=>Object(N.a)("/wiki"+e).catch(t)).then(e=>{this._spinnerOff(),this.props.open(e.url,"_blank")}).catch(()=>{this._spinnerOff()})})}_getContent(){if("tryit"===this.props.actionType&&!this.props.spaceKey)return null;const{formatMessage:e}=this.props.intl,t=e({id:"fabric.editor.announcement.greeting"},{0:this.props.displayName}),n=this.props.rolloutDate?e({id:this.props.mainMessageId},{0:this.props.rolloutDate}):e({id:this.props.mainMessageId}),a=e({id:this.props.actionMessageId}).replace(/ /g,"Â "),s=e({id:"fabric.editor.announcement.dismiss"});return c.a.createElement(I,{"data-test-id":"rollout-container",backgroundType:this.props.backgroundType},this.props.showIcon?c.a.createElement(D,null,"ðŸ‘‹"):null,c.a.createElement(k,null,this.props.showGreeting?c.a.createElement(S,null,t):null,c.a.createElement(M,null,` ${n} `),c.a.createElement(v,null,"tryit"===this.props.actionType?c.a.createElement("span",null,c.a.createElement("a",{onClick:this._onTryItLinkClick},a),"Â Â ",this.state.isCreatingNewPage?c.a.createElement(T.a,{size:"medium"}):null):c.a.createElement("a",{target:"_blank",href:this.props.actionUrl,onClick:this._onLearnMoreLinkClick},a))),c.a.createElement(R,{"data-test":"announcement-dismiss",onClick:this._onCloseClick},c.a.createElement(f.a,{size:"medium",label:s})))}componentDidMount(){this.props.isReady?this._willEventuallyRender()&&this._sendScreenEvent():this.props.getDiscoveredFeatures()}componentDidUpdate(e){!e.isReady&&this.props.isReady&&this._willEventuallyRender()&&this._sendScreenEvent()}render(){return this.props.isReady&&this.props.shouldRender?this._getContent():null}}const U=Object(b.g)(Object(y.a)()(Object(_.a)(w)));var L=Object(l.connect)((e,t)=>({isReady:Object(d.c)(e),shouldRender:!Object(d.b)(e,{pluginKey:h.b,featureKey:t.featureDiscoveryKey})}),e=>({getDiscoveredFeatures:()=>e(Object(u.b)()),dismissAnnouncement(t){if(null!==t){const n=Object(p.j)({pluginKey:h.b,featureKey:t});e(n)}}}))(U),P=n("H5qd");const x=n.n(P).a`query RolloutAnnouncementBannerQuery{user(current:true){id displayName confluence{space{id key}}}}`,V=1,K=2,z=3,F="https://confluence.atlassian.com/confcloud/confluence-editing-improvements-945107733.html";class Y extends a.Component{_getContent(e,t,n){var a,s;let r,o,l,u,p,d,h=!0,E=!0,b="wavey";const m=t||(null!=(s=n)&&null!=(s=s.user)&&null!=(s=s.confluence)&&null!=(s=s.space)?s.key:s);let y=e[i.r];if("tryit-notice"===e[i.s]){if(!m)return null;r=V,o="fabric.editor.announcement.tryitnotice.main",l="fabric.editor.announcement.tryit.action",u="tryit",h=!1,E=!1}else if("initial-notice"===e[i.s])r=K,o="fabric.editor.announcement.initialnotice.main",l="fabric.editor.announcement.link.action",u="link",p=F;else if("dated-notice"===e[i.s]){r=z,o="fabric.editor.announcement.datednotice.main",l="fabric.editor.announcement.link.action",u="link",p=F;const t=e[i.q].split("-");d=new Date(t[0],t[1],t[2]).toLocaleDateString()}else{if("accidental"!==e[i.p])return null;r=K,o="fabric.editor.announcement.rollbacknotice.main",l="fabric.editor.announcement.rollbacknotice.action",u="link",p="https://confluence.atlassian.com/confcloud/blog/2019/03/accidental-upgrade-to-the-new-editing-experience",h=!1,b="yellow",y="fabric.editor.announcement.rollback.message"}return c.a.createElement(L,{bannerType:r,mainMessageId:o,actionMessageId:l,backgroundType:b,actionType:u,actionUrl:p,featureDiscoveryKey:y,rolloutDate:d,spaceKey:m,showIcon:h,showGreeting:E,displayName:(null!=(a=n)&&null!=(a=a.user)?a.displayName:a)||null})}render(){return c.a.createElement(s.a,null,({featureFlags:e,userId:t})=>!t?null:c.a.createElement(r.b,{query:x},({data:t,loading:n,error:a})=>a||n||!t?null:c.a.createElement(o.a.Consumer,null,({spaceKey:n})=>this._getContent(e,n,t))))}}n.d(t,"RolloutAnnouncementComponent",(function(){return B}));const B=()=>c.a.createElement(Y,null)},"Z/GR":function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTI4MCIgaGVpZ2h0PSI1NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBkPSJNMCAxMS45ODNjOTYuNDYgMCA5OS45MTUgMzMuMDg0IDIwNC41NjQgMzMuMDg0IDEwNC42NDkgMCAyMTYuNTc2LTU4LjQyMiAzMTcuNzU2LTM3LjI4NSAxMDEuMTggMjEuMTM3IDIyNS40OSAzNy4yODUgMzU4LjY4IDBzMjEwLjAwNyA3NC4xNTMgMzEzIDI1Ljc2OGM0Ni0yMS42MSA1My45NDctMjEuMjU4IDg2LTIxLjU2N1Y1NS4wOUgwVjExLjk4M3oiIGZpbGw9IiNGRkYiIG9wYWNpdHk9Ii4yNSIvPjwvc3ZnPg=="}}]);
//# sourceMappingURL=page.rollout-banner~493df0b3.NeS8y6ZvTb.js.map